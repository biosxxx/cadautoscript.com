# Обзор и код-ревью — структура сайта CAD AutoScript

Этот файл содержит краткое код-ревью репозитория и подробное описание главной структуры сайта cadautoscript.com (Docusaurus + MDX + статические утилиты). Цель — зафиксировать архитектуру, точки входа для разработчиков и дать рекомендации по улучшению.

## Краткое резюме код-ревью

- Стек: Docusaurus (TypeScript), MDX для документации, статические HTML/JS приложения для утилит в папке `static/utilities/`.
- Положительные моменты:
  - Документация плотно связана с интерактивными утилитами (MDX + React/iframe-интеграция).
  - Хорошая структура папок: `docs/`, `src/`, `static/utilities/`, `scripts/`.
  - SEO-ориентированные страницы: JSON-LD, canonical ссылки, sitemap-скрипт.
- Основные замечания:
  - Много статических приложений как отдельные HTML-файлы — это удобно для простоты, но усложняет тестирование, типизацию и переиспользование.
  - Нет явных тестов и CI в репозитории (нет Playwright/Jest/ESLint configs visible).
  - Часть JS в `static` не использует TypeScript, что может привести к ошибкам при рефакторинге.

## Главная структура репозитория (файлы и папки)

- docusaurus.config.ts
  - Конфигурация Docusaurus: navbar, footer, плагины, presets (classic). Отвечает за глобальные параметры сайта, локализацию, кастомные css.

- docs/
  - MDX/Markdown-страницы с документацией. Каждая утилита имеет свою страницу с подробным описанием, JSON-LD и ссылкой на саму утилиту (например, `docs/utilities/*.mdx`).
  - В `docs/intro.md` описаны инструкции для контрибьюторов, quick-start и где располагаются компоненты/утилиты.

- src/
  - React-компоненты сайта и кастомные страницы. Пример: `src/pages/index.tsx` — главная страница; `src/css/` содержит кастомные темы и стили.
  - Компоненты аутентификации/поиска (в `docusaurus.config.ts` указаны `type: 'custom-search'` и `type: 'custom-navbar-auth'`).

- static/
  - Статические утилиты и ассеты. Каждая утилита может быть отдельным статическим приложением (HTML/JS/CSS): `static/utilities/*/app.html`, скрипты под `static/utilities/*/scripts/`.
  - Изображения и og-картинки в `static/img/`.

- scripts/
  - Утилиты для сборки/генерации: пример `scripts/sitemap-sections.js` — разделяет sitemap на секции и генерирует robots.txt.

- sidebars.ts (если присутствует)
  - Описывает боковые панели документации и порядок страниц в разделе Docs.

- package.json (корневой)
  - Содержит npm-скрипты: `start`, `build`, скорее всего `lint`, `test` если добавлены. (Рекомендуется проверить актуальный файл для списков скриптов и зависимостей).

## Как контент попадает на сайт (поток данных)

1. MDX-страницы в `docs/` рендерятся Docusaurus в статические HTML при сборке (`npm run build`).
2. React-страницы из `src/pages/` компилируются и включаются в роутинг (например, `/`, `/mini-games` и т.д.).
3. Статические утилиты из `static/utilities/` доступны напрямую по путям `/utilities/<slug>/` — эти страницы обычно самодостаточны (включают свои скрипты и стили).
4. Sitemap и robots генерируются (локально) скриптом в `scripts/` после сборки; `sitemap.xml` разбивается на секции.

## Ключевые точки входа и маршрутизация

- Главное приложение Docusaurus: точка сборки — конфигурация в `docusaurus.config.ts`.
- Документы: маршруты `/docs/...` формируются из `docs/` и `sidebars.ts`.
- Утилиты: маршрут `/utilities/<slug>/` направляет на статический HTML (в `static`), либо на MDX-страницу с кнопкой «Open utility» ведущей на `/utilities/<slug>/`.
- Блог: `/blog` управляется пресетом classic в Docusaurus.

## Безопасность, производительность и SEO

- На страницах явно присутствуют JSON-LD и canonical теги — хорошо для SEO.
- Статические приложения работают client-side (WASM/WebGL) — нужно следить за размерами бандлов и WASM, lazy-load рекомендуется.
- Рекомендуется минимизировать inline-скрипты и обеспечить Content Security Policy (CSP) при деплое.

## Рекомендации и задачи (приоритеты)

1. Тесты и CI (высокий приоритет)
   - Добавить базовый CI (GitHub Actions) с шагами: install, build, lint, unit tests, E2E (Playwright) тесты для ключевых утилит.
2. Типизация и стандарты (средний)
   - Рассмотреть миграцию скриптов из `static/...` на TypeScript или обернуть их в минимальную тестируемую оболочку.
   - Добавить ESLint/Prettier конфигурации и enforce pre-commit hooks (husky).
3. Модернизация статических утилит (опционально)
   - Для распространённых утилит подумать о переносе в React-обёртки (в `src/components/`), чтобы переиспользовать код и упростить интеграцию с MDX.
4. Производительность (средний)
   - Внедрить lazy-loading для тяжёлых WASM/скриптов, оптимизировать изображения, включить мониторинг размера бандлов.
5. Документация для контрибьюторов (низкий/средний)
   - Расширить CONTRIBUTING.md: как добавлять утилиту, стандарты кодирования, шаблоны PR/Issue.

## Заключение

Репозиторий хорошо организован для статической документации и клиентских утилит. Основные усилия стоит направить на покрытие тестами и CI, а также на постепенную типизацию и стандартизацию `static`-утилит для облегчения поддержки.

---

Автор: agent (код-ревью)
Дата: 2026-01-23