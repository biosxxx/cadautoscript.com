(function(){"use strict";var ft="/utilities/webstep-viewer/assets/occt-import-js-BhHfLpto.wasm";function dt(c){return c&&c.__esModule&&Object.prototype.hasOwnProperty.call(c,"default")?c.default:c}function vt(c){if(Object.prototype.hasOwnProperty.call(c,"__esModule"))return c;var v=c.default;if(typeof v=="function"){var h=function p(){return this instanceof p?Reflect.construct(v,arguments,this.constructor):v.apply(this,arguments)};h.prototype=v.prototype}else h={};return Object.defineProperty(h,"__esModule",{value:!0}),Object.keys(c).forEach(function(p){var g=Object.getOwnPropertyDescriptor(c,p);Object.defineProperty(h,p,g.get?g:{enumerable:!0,get:function(){return c[p]}})}),h}var Yr={exports:{}},ht={},mt=Object.freeze({__proto__:null,default:ht}),Gr=vt(mt),me;function pt(){return me||(me=1,(function(c,v){var h=(()=>{var g;var p=typeof document<"u"?(g=document.currentScript)==null?void 0:g.src:void 0;return typeof __filename<"u"&&(p=p||__filename),(function(y={}){var f,u=y,k,_,R=new Promise((r,e)=>{k=r,_=e}),$=typeof window=="object",I=typeof importScripts=="function",T=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string"&&process.type!="renderer",M=Object.assign({},u),O="./this.program",B=(r,e)=>{throw e},N="";function G(r){return u.locateFile?u.locateFile(r,N):N+r}var V,L;if(T){var J=Gr,x=Gr;N=__dirname+"/",L=r=>{r=zr(r)?new URL(r):x.normalize(r);var e=J.readFileSync(r);return e},V=(r,e=!0)=>(r=zr(r)?new URL(r):x.normalize(r),new Promise((t,n)=>{J.readFile(r,e?void 0:"utf8",(a,i)=>{a?n(a):t(e?i.buffer:i)})})),!u.thisProgram&&process.argv.length>1&&(O=process.argv[1].replace(/\\/g,"/")),process.argv.slice(2),B=(r,e)=>{throw process.exitCode=r,e}}else($||I)&&(I?N=self.location.href:typeof document<"u"&&document.currentScript&&(N=document.currentScript.src),p&&(N=p),N.startsWith("blob:")?N="":N=N.substr(0,N.replace(/[?#].*/,"").lastIndexOf("/")+1),I&&(L=r=>{var e=new XMLHttpRequest;return e.open("GET",r,!1),e.responseType="arraybuffer",e.send(null),new Uint8Array(e.response)}),V=r=>zr(r)?new Promise((e,t)=>{var n=new XMLHttpRequest;n.open("GET",r,!0),n.responseType="arraybuffer",n.onload=()=>{if(n.status==200||n.status==0&&n.response){e(n.response);return}t(n.status)},n.onerror=t,n.send(null)}):fetch(r,{credentials:"same-origin"}).then(e=>e.ok?e.arrayBuffer():Promise.reject(new Error(e.status+" : "+e.url))));var W=u.print||console.log.bind(console),Z=u.printErr||console.error.bind(console);Object.assign(u,M),M=null,u.arguments&&u.arguments,u.thisProgram&&(O=u.thisProgram);var or=u.wasmBinary,tr,cr=!1;function yr(r,e){r||Cr(e)}var q,Y,ar,kr,A,z,jr,Me;function Pe(){var r=tr.buffer;u.HEAP8=q=new Int8Array(r),u.HEAP16=ar=new Int16Array(r),u.HEAPU8=Y=new Uint8Array(r),u.HEAPU16=kr=new Uint16Array(r),u.HEAP32=A=new Int32Array(r),u.HEAPU32=z=new Uint32Array(r),u.HEAPF32=jr=new Float32Array(r),u.HEAPF64=Me=new Float64Array(r)}var Ce=[],Ie=[],Re=[],Ne=!1;function jt(){var r=u.preRun;r&&(typeof r=="function"&&(r=[r]),r.forEach(Ut)),ee(Ce)}function $t(){Ne=!0,!u.noFSInit&&!o.initialized&&o.init(),o.ignorePermissions=!1,ee(Ie)}function zt(){var r=u.postRun;r&&(typeof r=="function"&&(r=[r]),r.forEach(Bt)),ee(Re)}function Ut(r){Ce.unshift(r)}function Lt(r){Ie.unshift(r)}function Bt(r){Re.unshift(r)}var gr=0,Pr=null;function Ko(r){return r}function Qr(r){var e;gr++,(e=u.monitorRunDependencies)==null||e.call(u,gr)}function $r(r){var t;if(gr--,(t=u.monitorRunDependencies)==null||t.call(u,gr),gr==0&&Pr){var e=Pr;Pr=null,e()}}function Cr(r){var t;(t=u.onAbort)==null||t.call(u,r),r="Aborted("+r+")",Z(r),cr=!0,r+=". Build with -sASSERTIONS for more info.",Ne&&lt();var e=new WebAssembly.RuntimeError(r);throw _(e),e}var Wt="data:application/octet-stream;base64,",xe=r=>r.startsWith(Wt),zr=r=>r.startsWith("file://");function Vt(){var r="occt-import-js.wasm";return xe(r)?r:G(r)}var re;function Oe(r){if(r==re&&or)return new Uint8Array(or);if(L)return L(r);throw"both async and sync fetching of the wasm failed"}function Ht(r){return or?Promise.resolve().then(()=>Oe(r)):V(r).then(e=>new Uint8Array(e),()=>Oe(r))}function je(r,e,t){return Ht(r).then(n=>WebAssembly.instantiate(n,e)).then(t,n=>{Z(`failed to asynchronously prepare wasm: ${n}`),Cr(n)})}function qt(r,e,t,n){return!r&&typeof WebAssembly.instantiateStreaming=="function"&&!xe(e)&&!zr(e)&&!T&&typeof fetch=="function"?fetch(e,{credentials:"same-origin"}).then(a=>{var i=WebAssembly.instantiateStreaming(a,t);return i.then(n,function(s){return Z(`wasm streaming compile failed: ${s}`),Z("falling back to ArrayBuffer instantiation"),je(e,t,n)})}):je(e,t,n)}function Yt(){return{a:Xo}}function Gt(){var r=Yt();function e(n,a){return Q=n.exports,tr=Q._,Pe(),Ke=Q.ba,Lt(Q.$),$r(),Q}Qr();function t(n){e(n.instance)}if(u.instantiateWasm)try{return u.instantiateWasm(r,e)}catch(n){Z(`Module.instantiateWasm callback failed with error: ${n}`),_(n)}return re??(re=Vt()),qt(or,re,r,t).catch(_),{}}var P,X;function Xt(r){this.name="ExitStatus",this.message=`Program terminated with exit(${r})`,this.status=r}var ee=r=>{r.forEach(e=>e(u))};u.noExitRuntime;var U={isAbs:r=>r.charAt(0)==="/",splitPath:r=>{var e=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/;return e.exec(r).slice(1)},normalizeArray:(r,e)=>{for(var t=0,n=r.length-1;n>=0;n--){var a=r[n];a==="."?r.splice(n,1):a===".."?(r.splice(n,1),t++):t&&(r.splice(n,1),t--)}if(e)for(;t;t--)r.unshift("..");return r},normalize:r=>{var e=U.isAbs(r),t=r.substr(-1)==="/";return r=U.normalizeArray(r.split("/").filter(n=>!!n),!e).join("/"),!r&&!e&&(r="."),r&&t&&(r+="/"),(e?"/":"")+r},dirname:r=>{var e=U.splitPath(r),t=e[0],n=e[1];return!t&&!n?".":(n&&(n=n.substr(0,n.length-1)),t+n)},basename:r=>{if(r==="/")return"/";r=U.normalize(r),r=r.replace(/\/$/,"");var e=r.lastIndexOf("/");return e===-1?r:r.substr(e+1)},join:(...r)=>U.normalize(r.join("/")),join2:(r,e)=>U.normalize(r+"/"+e)},Kt=()=>{if(typeof crypto=="object"&&typeof crypto.getRandomValues=="function")return n=>crypto.getRandomValues(n);if(T)try{var r=Gr,e=r.randomFillSync;if(e)return n=>r.randomFillSync(n);var t=r.randomBytes;return n=>(n.set(t(n.byteLength)),n)}catch{}Cr("initRandomDevice")},$e=r=>($e=Kt())(r),dr={resolve:(...r)=>{for(var e="",t=!1,n=r.length-1;n>=-1&&!t;n--){var a=n>=0?r[n]:o.cwd();if(typeof a!="string")throw new TypeError("Arguments to path.resolve must be strings");if(!a)return"";e=a+"/"+e,t=U.isAbs(a)}return e=U.normalizeArray(e.split("/").filter(i=>!!i),!t).join("/"),(t?"/":"")+e||"."},relative:(r,e)=>{r=dr.resolve(r).substr(1),e=dr.resolve(e).substr(1);function t(m){for(var w=0;w<m.length&&m[w]==="";w++);for(var E=m.length-1;E>=0&&m[E]==="";E--);return w>E?[]:m.slice(w,E-w+1)}for(var n=t(r.split("/")),a=t(e.split("/")),i=Math.min(n.length,a.length),s=i,l=0;l<i;l++)if(n[l]!==a[l]){s=l;break}for(var d=[],l=s;l<n.length;l++)d.push("..");return d=d.concat(a.slice(s)),d.join("/")}},ze=typeof TextDecoder<"u"?new TextDecoder:void 0,Fr=(r,e=0,t=NaN)=>{for(var n=e+t,a=e;r[a]&&!(a>=n);)++a;if(a-e>16&&r.buffer&&ze)return ze.decode(r.subarray(e,a));for(var i="";e<a;){var s=r[e++];if(!(s&128)){i+=String.fromCharCode(s);continue}var l=r[e++]&63;if((s&224)==192){i+=String.fromCharCode((s&31)<<6|l);continue}var d=r[e++]&63;if((s&240)==224?s=(s&15)<<12|l<<6|d:s=(s&7)<<18|l<<12|d<<6|r[e++]&63,s<65536)i+=String.fromCharCode(s);else{var m=s-65536;i+=String.fromCharCode(55296|m>>10,56320|m&1023)}}return i},te=[],Ur=r=>{for(var e=0,t=0;t<r.length;++t){var n=r.charCodeAt(t);n<=127?e++:n<=2047?e+=2:n>=55296&&n<=57343?(e+=4,++t):e+=3}return e},ne=(r,e,t,n)=>{if(!(n>0))return 0;for(var a=t,i=t+n-1,s=0;s<r.length;++s){var l=r.charCodeAt(s);if(l>=55296&&l<=57343){var d=r.charCodeAt(++s);l=65536+((l&1023)<<10)|d&1023}if(l<=127){if(t>=i)break;e[t++]=l}else if(l<=2047){if(t+1>=i)break;e[t++]=192|l>>6,e[t++]=128|l&63}else if(l<=65535){if(t+2>=i)break;e[t++]=224|l>>12,e[t++]=128|l>>6&63,e[t++]=128|l&63}else{if(t+3>=i)break;e[t++]=240|l>>18,e[t++]=128|l>>12&63,e[t++]=128|l>>6&63,e[t++]=128|l&63}}return e[t]=0,t-a};function Ue(r,e,t){var n=Ur(r)+1,a=new Array(n),i=ne(r,a,0,a.length);return a.length=i,a}var Jt=()=>{if(!te.length){var r=null;if(T){var e=256,t=Buffer.alloc(e),n=0,a=process.stdin.fd;try{n=J.readSync(a,t,0,e)}catch(i){if(i.toString().includes("EOF"))n=0;else throw i}n>0&&(r=t.slice(0,n).toString("utf-8"))}else typeof window<"u"&&typeof window.prompt=="function"&&(r=window.prompt("Input: "),r!==null&&(r+=`
`));if(!r)return null;te=Ue(r)}return te.shift()},_r={ttys:[],init(){},shutdown(){},register(r,e){_r.ttys[r]={input:[],output:[],ops:e},o.registerDevice(r,_r.stream_ops)},stream_ops:{open(r){var e=_r.ttys[r.node.rdev];if(!e)throw new o.ErrnoError(43);r.tty=e,r.seekable=!1},close(r){r.tty.ops.fsync(r.tty)},fsync(r){r.tty.ops.fsync(r.tty)},read(r,e,t,n,a){if(!r.tty||!r.tty.ops.get_char)throw new o.ErrnoError(60);for(var i=0,s=0;s<n;s++){var l;try{l=r.tty.ops.get_char(r.tty)}catch{throw new o.ErrnoError(29)}if(l===void 0&&i===0)throw new o.ErrnoError(6);if(l==null)break;i++,e[t+s]=l}return i&&(r.node.timestamp=Date.now()),i},write(r,e,t,n,a){if(!r.tty||!r.tty.ops.put_char)throw new o.ErrnoError(60);try{for(var i=0;i<n;i++)r.tty.ops.put_char(r.tty,e[t+i])}catch{throw new o.ErrnoError(29)}return n&&(r.node.timestamp=Date.now()),i}},default_tty_ops:{get_char(r){return Jt()},put_char(r,e){e===null||e===10?(W(Fr(r.output)),r.output=[]):e!=0&&r.output.push(e)},fsync(r){r.output&&r.output.length>0&&(W(Fr(r.output)),r.output=[])},ioctl_tcgets(r){return{c_iflag:25856,c_oflag:5,c_cflag:191,c_lflag:35387,c_cc:[3,28,127,21,4,0,1,0,17,19,26,0,18,15,23,22,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}},ioctl_tcsets(r,e,t){return 0},ioctl_tiocgwinsz(r){return[24,80]}},default_tty1_ops:{put_char(r,e){e===null||e===10?(Z(Fr(r.output)),r.output=[]):e!=0&&r.output.push(e)},fsync(r){r.output&&r.output.length>0&&(Z(Fr(r.output)),r.output=[])}}},Zt=(r,e)=>{Y.fill(0,r,r+e)},Le=(r,e)=>Math.ceil(r/e)*e,Be=r=>{r=Le(r,65536);var e=st(65536,r);return e&&Zt(e,r),e},D={ops_table:null,mount(r){return D.createNode(null,"/",16895,0)},createNode(r,e,t,n){if(o.isBlkdev(t)||o.isFIFO(t))throw new o.ErrnoError(63);D.ops_table||(D.ops_table={dir:{node:{getattr:D.node_ops.getattr,setattr:D.node_ops.setattr,lookup:D.node_ops.lookup,mknod:D.node_ops.mknod,rename:D.node_ops.rename,unlink:D.node_ops.unlink,rmdir:D.node_ops.rmdir,readdir:D.node_ops.readdir,symlink:D.node_ops.symlink},stream:{llseek:D.stream_ops.llseek}},file:{node:{getattr:D.node_ops.getattr,setattr:D.node_ops.setattr},stream:{llseek:D.stream_ops.llseek,read:D.stream_ops.read,write:D.stream_ops.write,allocate:D.stream_ops.allocate,mmap:D.stream_ops.mmap,msync:D.stream_ops.msync}},link:{node:{getattr:D.node_ops.getattr,setattr:D.node_ops.setattr,readlink:D.node_ops.readlink},stream:{}},chrdev:{node:{getattr:D.node_ops.getattr,setattr:D.node_ops.setattr},stream:o.chrdev_stream_ops}});var a=o.createNode(r,e,t,n);return o.isDir(a.mode)?(a.node_ops=D.ops_table.dir.node,a.stream_ops=D.ops_table.dir.stream,a.contents={}):o.isFile(a.mode)?(a.node_ops=D.ops_table.file.node,a.stream_ops=D.ops_table.file.stream,a.usedBytes=0,a.contents=null):o.isLink(a.mode)?(a.node_ops=D.ops_table.link.node,a.stream_ops=D.ops_table.link.stream):o.isChrdev(a.mode)&&(a.node_ops=D.ops_table.chrdev.node,a.stream_ops=D.ops_table.chrdev.stream),a.timestamp=Date.now(),r&&(r.contents[e]=a,r.timestamp=a.timestamp),a},getFileDataAsTypedArray(r){return r.contents?r.contents.subarray?r.contents.subarray(0,r.usedBytes):new Uint8Array(r.contents):new Uint8Array(0)},expandFileStorage(r,e){var t=r.contents?r.contents.length:0;if(!(t>=e)){var n=1024*1024;e=Math.max(e,t*(t<n?2:1.125)>>>0),t!=0&&(e=Math.max(e,256));var a=r.contents;r.contents=new Uint8Array(e),r.usedBytes>0&&r.contents.set(a.subarray(0,r.usedBytes),0)}},resizeFileStorage(r,e){if(r.usedBytes!=e)if(e==0)r.contents=null,r.usedBytes=0;else{var t=r.contents;r.contents=new Uint8Array(e),t&&r.contents.set(t.subarray(0,Math.min(e,r.usedBytes))),r.usedBytes=e}},node_ops:{getattr(r){var e={};return e.dev=o.isChrdev(r.mode)?r.id:1,e.ino=r.id,e.mode=r.mode,e.nlink=1,e.uid=0,e.gid=0,e.rdev=r.rdev,o.isDir(r.mode)?e.size=4096:o.isFile(r.mode)?e.size=r.usedBytes:o.isLink(r.mode)?e.size=r.link.length:e.size=0,e.atime=new Date(r.timestamp),e.mtime=new Date(r.timestamp),e.ctime=new Date(r.timestamp),e.blksize=4096,e.blocks=Math.ceil(e.size/e.blksize),e},setattr(r,e){e.mode!==void 0&&(r.mode=e.mode),e.timestamp!==void 0&&(r.timestamp=e.timestamp),e.size!==void 0&&D.resizeFileStorage(r,e.size)},lookup(r,e){throw o.genericErrors[44]},mknod(r,e,t,n){return D.createNode(r,e,t,n)},rename(r,e,t){if(o.isDir(r.mode)){var n;try{n=o.lookupNode(e,t)}catch{}if(n)for(var a in n.contents)throw new o.ErrnoError(55)}delete r.parent.contents[r.name],r.parent.timestamp=Date.now(),r.name=t,e.contents[t]=r,e.timestamp=r.parent.timestamp},unlink(r,e){delete r.contents[e],r.timestamp=Date.now()},rmdir(r,e){var t=o.lookupNode(r,e);for(var n in t.contents)throw new o.ErrnoError(55);delete r.contents[e],r.timestamp=Date.now()},readdir(r){var e=[".",".."];for(var t of Object.keys(r.contents))e.push(t);return e},symlink(r,e,t){var n=D.createNode(r,e,41471,0);return n.link=t,n},readlink(r){if(!o.isLink(r.mode))throw new o.ErrnoError(28);return r.link}},stream_ops:{read(r,e,t,n,a){var i=r.node.contents;if(a>=r.node.usedBytes)return 0;var s=Math.min(r.node.usedBytes-a,n);if(s>8&&i.subarray)e.set(i.subarray(a,a+s),t);else for(var l=0;l<s;l++)e[t+l]=i[a+l];return s},write(r,e,t,n,a,i){if(e.buffer===q.buffer&&(i=!1),!n)return 0;var s=r.node;if(s.timestamp=Date.now(),e.subarray&&(!s.contents||s.contents.subarray)){if(i)return s.contents=e.subarray(t,t+n),s.usedBytes=n,n;if(s.usedBytes===0&&a===0)return s.contents=e.slice(t,t+n),s.usedBytes=n,n;if(a+n<=s.usedBytes)return s.contents.set(e.subarray(t,t+n),a),n}if(D.expandFileStorage(s,a+n),s.contents.subarray&&e.subarray)s.contents.set(e.subarray(t,t+n),a);else for(var l=0;l<n;l++)s.contents[a+l]=e[t+l];return s.usedBytes=Math.max(s.usedBytes,a+n),n},llseek(r,e,t){var n=e;if(t===1?n+=r.position:t===2&&o.isFile(r.node.mode)&&(n+=r.node.usedBytes),n<0)throw new o.ErrnoError(28);return n},allocate(r,e,t){D.expandFileStorage(r.node,e+t),r.node.usedBytes=Math.max(r.node.usedBytes,e+t)},mmap(r,e,t,n,a){if(!o.isFile(r.node.mode))throw new o.ErrnoError(43);var i,s,l=r.node.contents;if(!(a&2)&&l&&l.buffer===q.buffer)s=!1,i=l.byteOffset;else{if(s=!0,i=Be(e),!i)throw new o.ErrnoError(48);l&&((t>0||t+e<l.length)&&(l.subarray?l=l.subarray(t,t+e):l=Array.prototype.slice.call(l,t,t+e)),q.set(l,i))}return{ptr:i,allocated:s}},msync(r,e,t,n,a){return D.stream_ops.write(r,e,0,n,t,!1),0}}},Qt=(r,e,t,n)=>{var a=`al ${r}`;V(r).then(i=>{e(new Uint8Array(i)),a&&$r()},i=>{if(t)t();else throw`Loading data file "${r}" failed.`}),a&&Qr()},rn=(r,e,t,n,a,i)=>{o.createDataFile(r,e,t,n,a,i)},en=u.preloadPlugins||[],tn=(r,e,t,n)=>{typeof Browser<"u"&&Browser.init();var a=!1;return en.forEach(i=>{a||i.canHandle(e)&&(i.handle(r,e,t,n),a=!0)}),a},nn=(r,e,t,n,a,i,s,l,d,m)=>{var w=e?dr.resolve(U.join2(r,e)):r;function E(F){function b(S){m==null||m(),l||rn(r,e,S,n,a,d),i==null||i(),$r()}tn(F,w,b,()=>{s==null||s(),$r()})||b(F)}Qr(),typeof t=="string"?Qt(t,E,s):E(t)},on=r=>{var e={r:0,"r+":2,w:577,"w+":578,a:1089,"a+":1090},t=e[r];if(typeof t>"u")throw new Error(`Unknown file open mode: ${r}`);return t},oe=(r,e)=>{var t=0;return r&&(t|=365),e&&(t|=146),t},o={root:null,mounts:[],devices:{},streams:[],nextInode:1,nameTable:null,currentPath:"/",initialized:!1,ignorePermissions:!0,ErrnoError:class{constructor(r){this.name="ErrnoError",this.errno=r}},genericErrors:{},filesystems:null,syncFSRequests:0,readFiles:{},FSStream:class{constructor(){this.shared={}}get object(){return this.node}set object(r){this.node=r}get isRead(){return(this.flags&2097155)!==1}get isWrite(){return(this.flags&2097155)!==0}get isAppend(){return this.flags&1024}get flags(){return this.shared.flags}set flags(r){this.shared.flags=r}get position(){return this.shared.position}set position(r){this.shared.position=r}},FSNode:class{constructor(r,e,t,n){r||(r=this),this.parent=r,this.mount=r.mount,this.mounted=null,this.id=o.nextInode++,this.name=e,this.mode=t,this.node_ops={},this.stream_ops={},this.rdev=n,this.readMode=365,this.writeMode=146}get read(){return(this.mode&this.readMode)===this.readMode}set read(r){r?this.mode|=this.readMode:this.mode&=~this.readMode}get write(){return(this.mode&this.writeMode)===this.writeMode}set write(r){r?this.mode|=this.writeMode:this.mode&=~this.writeMode}get isFolder(){return o.isDir(this.mode)}get isDevice(){return o.isChrdev(this.mode)}},lookupPath(r,e={}){if(r=dr.resolve(r),!r)return{path:"",node:null};var t={follow_mount:!0,recurse_count:0};if(e=Object.assign(t,e),e.recurse_count>8)throw new o.ErrnoError(32);for(var n=r.split("/").filter(E=>!!E),a=o.root,i="/",s=0;s<n.length;s++){var l=s===n.length-1;if(l&&e.parent)break;if(a=o.lookupNode(a,n[s]),i=U.join2(i,n[s]),o.isMountpoint(a)&&(!l||l&&e.follow_mount)&&(a=a.mounted.root),!l||e.follow)for(var d=0;o.isLink(a.mode);){var m=o.readlink(i);i=dr.resolve(U.dirname(i),m);var w=o.lookupPath(i,{recurse_count:e.recurse_count+1});if(a=w.node,d++>40)throw new o.ErrnoError(32)}}return{path:i,node:a}},getPath(r){for(var e;;){if(o.isRoot(r)){var t=r.mount.mountpoint;return e?t[t.length-1]!=="/"?`${t}/${e}`:t+e:t}e=e?`${r.name}/${e}`:r.name,r=r.parent}},hashName(r,e){for(var t=0,n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n)|0;return(r+t>>>0)%o.nameTable.length},hashAddNode(r){var e=o.hashName(r.parent.id,r.name);r.name_next=o.nameTable[e],o.nameTable[e]=r},hashRemoveNode(r){var e=o.hashName(r.parent.id,r.name);if(o.nameTable[e]===r)o.nameTable[e]=r.name_next;else for(var t=o.nameTable[e];t;){if(t.name_next===r){t.name_next=r.name_next;break}t=t.name_next}},lookupNode(r,e){var t=o.mayLookup(r);if(t)throw new o.ErrnoError(t);for(var n=o.hashName(r.id,e),a=o.nameTable[n];a;a=a.name_next){var i=a.name;if(a.parent.id===r.id&&i===e)return a}return o.lookup(r,e)},createNode(r,e,t,n){var a=new o.FSNode(r,e,t,n);return o.hashAddNode(a),a},destroyNode(r){o.hashRemoveNode(r)},isRoot(r){return r===r.parent},isMountpoint(r){return!!r.mounted},isFile(r){return(r&61440)===32768},isDir(r){return(r&61440)===16384},isLink(r){return(r&61440)===40960},isChrdev(r){return(r&61440)===8192},isBlkdev(r){return(r&61440)===24576},isFIFO(r){return(r&61440)===4096},isSocket(r){return(r&49152)===49152},flagsToPermissionString(r){var e=["r","w","rw"][r&3];return r&512&&(e+="w"),e},nodePermissions(r,e){return o.ignorePermissions?0:e.includes("r")&&!(r.mode&292)||e.includes("w")&&!(r.mode&146)||e.includes("x")&&!(r.mode&73)?2:0},mayLookup(r){if(!o.isDir(r.mode))return 54;var e=o.nodePermissions(r,"x");return e||(r.node_ops.lookup?0:2)},mayCreate(r,e){try{var t=o.lookupNode(r,e);return 20}catch{}return o.nodePermissions(r,"wx")},mayDelete(r,e,t){var n;try{n=o.lookupNode(r,e)}catch(i){return i.errno}var a=o.nodePermissions(r,"wx");if(a)return a;if(t){if(!o.isDir(n.mode))return 54;if(o.isRoot(n)||o.getPath(n)===o.cwd())return 10}else if(o.isDir(n.mode))return 31;return 0},mayOpen(r,e){return r?o.isLink(r.mode)?32:o.isDir(r.mode)&&(o.flagsToPermissionString(e)!=="r"||e&512)?31:o.nodePermissions(r,o.flagsToPermissionString(e)):44},MAX_OPEN_FDS:4096,nextfd(){for(var r=0;r<=o.MAX_OPEN_FDS;r++)if(!o.streams[r])return r;throw new o.ErrnoError(33)},getStreamChecked(r){var e=o.getStream(r);if(!e)throw new o.ErrnoError(8);return e},getStream:r=>o.streams[r],createStream(r,e=-1){return r=Object.assign(new o.FSStream,r),e==-1&&(e=o.nextfd()),r.fd=e,o.streams[e]=r,r},closeStream(r){o.streams[r]=null},dupStream(r,e=-1){var n,a;var t=o.createStream(r,e);return(a=(n=t.stream_ops)==null?void 0:n.dup)==null||a.call(n,t),t},chrdev_stream_ops:{open(r){var t,n;var e=o.getDevice(r.node.rdev);r.stream_ops=e.stream_ops,(n=(t=r.stream_ops).open)==null||n.call(t,r)},llseek(){throw new o.ErrnoError(70)}},major:r=>r>>8,minor:r=>r&255,makedev:(r,e)=>r<<8|e,registerDevice(r,e){o.devices[r]={stream_ops:e}},getDevice:r=>o.devices[r],getMounts(r){for(var e=[],t=[r];t.length;){var n=t.pop();e.push(n),t.push(...n.mounts)}return e},syncfs(r,e){typeof r=="function"&&(e=r,r=!1),o.syncFSRequests++,o.syncFSRequests>1&&Z(`warning: ${o.syncFSRequests} FS.syncfs operations in flight at once, probably just doing extra work`);var t=o.getMounts(o.root.mount),n=0;function a(s){return o.syncFSRequests--,e(s)}function i(s){if(s)return i.errored?void 0:(i.errored=!0,a(s));++n>=t.length&&a(null)}t.forEach(s=>{if(!s.type.syncfs)return i(null);s.type.syncfs(s,r,i)})},mount(r,e,t){var n=t==="/",a=!t,i;if(n&&o.root)throw new o.ErrnoError(10);if(!n&&!a){var s=o.lookupPath(t,{follow_mount:!1});if(t=s.path,i=s.node,o.isMountpoint(i))throw new o.ErrnoError(10);if(!o.isDir(i.mode))throw new o.ErrnoError(54)}var l={type:r,opts:e,mountpoint:t,mounts:[]},d=r.mount(l);return d.mount=l,l.root=d,n?o.root=d:i&&(i.mounted=l,i.mount&&i.mount.mounts.push(l)),d},unmount(r){var e=o.lookupPath(r,{follow_mount:!1});if(!o.isMountpoint(e.node))throw new o.ErrnoError(28);var t=e.node,n=t.mounted,a=o.getMounts(n);Object.keys(o.nameTable).forEach(s=>{for(var l=o.nameTable[s];l;){var d=l.name_next;a.includes(l.mount)&&o.destroyNode(l),l=d}}),t.mounted=null;var i=t.mount.mounts.indexOf(n);t.mount.mounts.splice(i,1)},lookup(r,e){return r.node_ops.lookup(r,e)},mknod(r,e,t){var n=o.lookupPath(r,{parent:!0}),a=n.node,i=U.basename(r);if(!i||i==="."||i==="..")throw new o.ErrnoError(28);var s=o.mayCreate(a,i);if(s)throw new o.ErrnoError(s);if(!a.node_ops.mknod)throw new o.ErrnoError(63);return a.node_ops.mknod(a,i,e,t)},create(r,e){return e=e!==void 0?e:438,e&=4095,e|=32768,o.mknod(r,e,0)},mkdir(r,e){return e=e!==void 0?e:511,e&=1023,e|=16384,o.mknod(r,e,0)},mkdirTree(r,e){for(var t=r.split("/"),n="",a=0;a<t.length;++a)if(t[a]){n+="/"+t[a];try{o.mkdir(n,e)}catch(i){if(i.errno!=20)throw i}}},mkdev(r,e,t){return typeof t>"u"&&(t=e,e=438),e|=8192,o.mknod(r,e,t)},symlink(r,e){if(!dr.resolve(r))throw new o.ErrnoError(44);var t=o.lookupPath(e,{parent:!0}),n=t.node;if(!n)throw new o.ErrnoError(44);var a=U.basename(e),i=o.mayCreate(n,a);if(i)throw new o.ErrnoError(i);if(!n.node_ops.symlink)throw new o.ErrnoError(63);return n.node_ops.symlink(n,a,r)},rename(r,e){var t=U.dirname(r),n=U.dirname(e),a=U.basename(r),i=U.basename(e),s,l,d;if(s=o.lookupPath(r,{parent:!0}),l=s.node,s=o.lookupPath(e,{parent:!0}),d=s.node,!l||!d)throw new o.ErrnoError(44);if(l.mount!==d.mount)throw new o.ErrnoError(75);var m=o.lookupNode(l,a),w=dr.relative(r,n);if(w.charAt(0)!==".")throw new o.ErrnoError(28);if(w=dr.relative(e,t),w.charAt(0)!==".")throw new o.ErrnoError(55);var E;try{E=o.lookupNode(d,i)}catch{}if(m!==E){var F=o.isDir(m.mode),b=o.mayDelete(l,a,F);if(b)throw new o.ErrnoError(b);if(b=E?o.mayDelete(d,i,F):o.mayCreate(d,i),b)throw new o.ErrnoError(b);if(!l.node_ops.rename)throw new o.ErrnoError(63);if(o.isMountpoint(m)||E&&o.isMountpoint(E))throw new o.ErrnoError(10);if(d!==l&&(b=o.nodePermissions(l,"w"),b))throw new o.ErrnoError(b);o.hashRemoveNode(m);try{l.node_ops.rename(m,d,i),m.parent=d}catch(S){throw S}finally{o.hashAddNode(m)}}},rmdir(r){var e=o.lookupPath(r,{parent:!0}),t=e.node,n=U.basename(r),a=o.lookupNode(t,n),i=o.mayDelete(t,n,!0);if(i)throw new o.ErrnoError(i);if(!t.node_ops.rmdir)throw new o.ErrnoError(63);if(o.isMountpoint(a))throw new o.ErrnoError(10);t.node_ops.rmdir(t,n),o.destroyNode(a)},readdir(r){var e=o.lookupPath(r,{follow:!0}),t=e.node;if(!t.node_ops.readdir)throw new o.ErrnoError(54);return t.node_ops.readdir(t)},unlink(r){var e=o.lookupPath(r,{parent:!0}),t=e.node;if(!t)throw new o.ErrnoError(44);var n=U.basename(r),a=o.lookupNode(t,n),i=o.mayDelete(t,n,!1);if(i)throw new o.ErrnoError(i);if(!t.node_ops.unlink)throw new o.ErrnoError(63);if(o.isMountpoint(a))throw new o.ErrnoError(10);t.node_ops.unlink(t,n),o.destroyNode(a)},readlink(r){var e=o.lookupPath(r),t=e.node;if(!t)throw new o.ErrnoError(44);if(!t.node_ops.readlink)throw new o.ErrnoError(28);return dr.resolve(o.getPath(t.parent),t.node_ops.readlink(t))},stat(r,e){var t=o.lookupPath(r,{follow:!e}),n=t.node;if(!n)throw new o.ErrnoError(44);if(!n.node_ops.getattr)throw new o.ErrnoError(63);return n.node_ops.getattr(n)},lstat(r){return o.stat(r,!0)},chmod(r,e,t){var n;if(typeof r=="string"){var a=o.lookupPath(r,{follow:!t});n=a.node}else n=r;if(!n.node_ops.setattr)throw new o.ErrnoError(63);n.node_ops.setattr(n,{mode:e&4095|n.mode&-4096,timestamp:Date.now()})},lchmod(r,e){o.chmod(r,e,!0)},fchmod(r,e){var t=o.getStreamChecked(r);o.chmod(t.node,e)},chown(r,e,t,n){var a;if(typeof r=="string"){var i=o.lookupPath(r,{follow:!n});a=i.node}else a=r;if(!a.node_ops.setattr)throw new o.ErrnoError(63);a.node_ops.setattr(a,{timestamp:Date.now()})},lchown(r,e,t){o.chown(r,e,t,!0)},fchown(r,e,t){var n=o.getStreamChecked(r);o.chown(n.node,e,t)},truncate(r,e){if(e<0)throw new o.ErrnoError(28);var t;if(typeof r=="string"){var n=o.lookupPath(r,{follow:!0});t=n.node}else t=r;if(!t.node_ops.setattr)throw new o.ErrnoError(63);if(o.isDir(t.mode))throw new o.ErrnoError(31);if(!o.isFile(t.mode))throw new o.ErrnoError(28);var a=o.nodePermissions(t,"w");if(a)throw new o.ErrnoError(a);t.node_ops.setattr(t,{size:e,timestamp:Date.now()})},ftruncate(r,e){var t=o.getStreamChecked(r);if((t.flags&2097155)===0)throw new o.ErrnoError(28);o.truncate(t.node,e)},utime(r,e,t){var n=o.lookupPath(r,{follow:!0}),a=n.node;a.node_ops.setattr(a,{timestamp:Math.max(e,t)})},open(r,e,t){if(r==="")throw new o.ErrnoError(44);e=typeof e=="string"?on(e):e,e&64?(t=typeof t>"u"?438:t,t=t&4095|32768):t=0;var n;if(typeof r=="object")n=r;else{r=U.normalize(r);try{var a=o.lookupPath(r,{follow:!(e&131072)});n=a.node}catch{}}var i=!1;if(e&64)if(n){if(e&128)throw new o.ErrnoError(20)}else n=o.mknod(r,t,0),i=!0;if(!n)throw new o.ErrnoError(44);if(o.isChrdev(n.mode)&&(e&=-513),e&65536&&!o.isDir(n.mode))throw new o.ErrnoError(54);if(!i){var s=o.mayOpen(n,e);if(s)throw new o.ErrnoError(s)}e&512&&!i&&o.truncate(n,0),e&=-131713;var l=o.createStream({node:n,path:o.getPath(n),flags:e,seekable:!0,position:0,stream_ops:n.stream_ops,ungotten:[],error:!1});return l.stream_ops.open&&l.stream_ops.open(l),u.logReadFiles&&!(e&1)&&(r in o.readFiles||(o.readFiles[r]=1)),l},close(r){if(o.isClosed(r))throw new o.ErrnoError(8);r.getdents&&(r.getdents=null);try{r.stream_ops.close&&r.stream_ops.close(r)}catch(e){throw e}finally{o.closeStream(r.fd)}r.fd=null},isClosed(r){return r.fd===null},llseek(r,e,t){if(o.isClosed(r))throw new o.ErrnoError(8);if(!r.seekable||!r.stream_ops.llseek)throw new o.ErrnoError(70);if(t!=0&&t!=1&&t!=2)throw new o.ErrnoError(28);return r.position=r.stream_ops.llseek(r,e,t),r.ungotten=[],r.position},read(r,e,t,n,a){if(n<0||a<0)throw new o.ErrnoError(28);if(o.isClosed(r))throw new o.ErrnoError(8);if((r.flags&2097155)===1)throw new o.ErrnoError(8);if(o.isDir(r.node.mode))throw new o.ErrnoError(31);if(!r.stream_ops.read)throw new o.ErrnoError(28);var i=typeof a<"u";if(!i)a=r.position;else if(!r.seekable)throw new o.ErrnoError(70);var s=r.stream_ops.read(r,e,t,n,a);return i||(r.position+=s),s},write(r,e,t,n,a,i){if(n<0||a<0)throw new o.ErrnoError(28);if(o.isClosed(r))throw new o.ErrnoError(8);if((r.flags&2097155)===0)throw new o.ErrnoError(8);if(o.isDir(r.node.mode))throw new o.ErrnoError(31);if(!r.stream_ops.write)throw new o.ErrnoError(28);r.seekable&&r.flags&1024&&o.llseek(r,0,2);var s=typeof a<"u";if(!s)a=r.position;else if(!r.seekable)throw new o.ErrnoError(70);var l=r.stream_ops.write(r,e,t,n,a,i);return s||(r.position+=l),l},allocate(r,e,t){if(o.isClosed(r))throw new o.ErrnoError(8);if(e<0||t<=0)throw new o.ErrnoError(28);if((r.flags&2097155)===0)throw new o.ErrnoError(8);if(!o.isFile(r.node.mode)&&!o.isDir(r.node.mode))throw new o.ErrnoError(43);if(!r.stream_ops.allocate)throw new o.ErrnoError(138);r.stream_ops.allocate(r,e,t)},mmap(r,e,t,n,a){if((n&2)!==0&&(a&2)===0&&(r.flags&2097155)!==2)throw new o.ErrnoError(2);if((r.flags&2097155)===1)throw new o.ErrnoError(2);if(!r.stream_ops.mmap)throw new o.ErrnoError(43);if(!e)throw new o.ErrnoError(28);return r.stream_ops.mmap(r,e,t,n,a)},msync(r,e,t,n,a){return r.stream_ops.msync?r.stream_ops.msync(r,e,t,n,a):0},ioctl(r,e,t){if(!r.stream_ops.ioctl)throw new o.ErrnoError(59);return r.stream_ops.ioctl(r,e,t)},readFile(r,e={}){if(e.flags=e.flags||0,e.encoding=e.encoding||"binary",e.encoding!=="utf8"&&e.encoding!=="binary")throw new Error(`Invalid encoding type "${e.encoding}"`);var t,n=o.open(r,e.flags),a=o.stat(r),i=a.size,s=new Uint8Array(i);return o.read(n,s,0,i,0),e.encoding==="utf8"?t=Fr(s):e.encoding==="binary"&&(t=s),o.close(n),t},writeFile(r,e,t={}){t.flags=t.flags||577;var n=o.open(r,t.flags,t.mode);if(typeof e=="string"){var a=new Uint8Array(Ur(e)+1),i=ne(e,a,0,a.length);o.write(n,a,0,i,void 0,t.canOwn)}else if(ArrayBuffer.isView(e))o.write(n,e,0,e.byteLength,void 0,t.canOwn);else throw new Error("Unsupported data type");o.close(n)},cwd:()=>o.currentPath,chdir(r){var e=o.lookupPath(r,{follow:!0});if(e.node===null)throw new o.ErrnoError(44);if(!o.isDir(e.node.mode))throw new o.ErrnoError(54);var t=o.nodePermissions(e.node,"x");if(t)throw new o.ErrnoError(t);o.currentPath=e.path},createDefaultDirectories(){o.mkdir("/tmp"),o.mkdir("/home"),o.mkdir("/home/web_user")},createDefaultDevices(){o.mkdir("/dev"),o.registerDevice(o.makedev(1,3),{read:()=>0,write:(n,a,i,s,l)=>s}),o.mkdev("/dev/null",o.makedev(1,3)),_r.register(o.makedev(5,0),_r.default_tty_ops),_r.register(o.makedev(6,0),_r.default_tty1_ops),o.mkdev("/dev/tty",o.makedev(5,0)),o.mkdev("/dev/tty1",o.makedev(6,0));var r=new Uint8Array(1024),e=0,t=()=>(e===0&&(e=$e(r).byteLength),r[--e]);o.createDevice("/dev","random",t),o.createDevice("/dev","urandom",t),o.mkdir("/dev/shm"),o.mkdir("/dev/shm/tmp")},createSpecialDirectories(){o.mkdir("/proc");var r=o.mkdir("/proc/self");o.mkdir("/proc/self/fd"),o.mount({mount(){var e=o.createNode(r,"fd",16895,73);return e.node_ops={lookup(t,n){var a=+n,i=o.getStreamChecked(a),s={parent:null,mount:{mountpoint:"fake"},node_ops:{readlink:()=>i.path}};return s.parent=s,s}},e}},{},"/proc/self/fd")},createStandardStreams(r,e,t){r?o.createDevice("/dev","stdin",r):o.symlink("/dev/tty","/dev/stdin"),e?o.createDevice("/dev","stdout",null,e):o.symlink("/dev/tty","/dev/stdout"),t?o.createDevice("/dev","stderr",null,t):o.symlink("/dev/tty1","/dev/stderr"),o.open("/dev/stdin",0),o.open("/dev/stdout",1),o.open("/dev/stderr",1)},staticInit(){[44].forEach(r=>{o.genericErrors[r]=new o.ErrnoError(r),o.genericErrors[r].stack="<generic error, no stack>"}),o.nameTable=new Array(4096),o.mount(D,{},"/"),o.createDefaultDirectories(),o.createDefaultDevices(),o.createSpecialDirectories(),o.filesystems={MEMFS:D}},init(r,e,t){o.initialized=!0,r??(r=u.stdin),e??(e=u.stdout),t??(t=u.stderr),o.createStandardStreams(r,e,t)},quit(){o.initialized=!1;for(var r=0;r<o.streams.length;r++){var e=o.streams[r];e&&o.close(e)}},findObject(r,e){var t=o.analyzePath(r,e);return t.exists?t.object:null},analyzePath(r,e){try{var t=o.lookupPath(r,{follow:!e});r=t.path}catch{}var n={isRoot:!1,exists:!1,error:0,name:null,path:null,object:null,parentExists:!1,parentPath:null,parentObject:null};try{var t=o.lookupPath(r,{parent:!0});n.parentExists=!0,n.parentPath=t.path,n.parentObject=t.node,n.name=U.basename(r),t=o.lookupPath(r,{follow:!e}),n.exists=!0,n.path=t.path,n.object=t.node,n.name=t.node.name,n.isRoot=t.path==="/"}catch(a){n.error=a.errno}return n},createPath(r,e,t,n){r=typeof r=="string"?r:o.getPath(r);for(var a=e.split("/").reverse();a.length;){var i=a.pop();if(i){var s=U.join2(r,i);try{o.mkdir(s)}catch{}r=s}}return s},createFile(r,e,t,n,a){var i=U.join2(typeof r=="string"?r:o.getPath(r),e),s=oe(n,a);return o.create(i,s)},createDataFile(r,e,t,n,a,i){var s=e;r&&(r=typeof r=="string"?r:o.getPath(r),s=e?U.join2(r,e):r);var l=oe(n,a),d=o.create(s,l);if(t){if(typeof t=="string"){for(var m=new Array(t.length),w=0,E=t.length;w<E;++w)m[w]=t.charCodeAt(w);t=m}o.chmod(d,l|146);var F=o.open(d,577);o.write(F,t,0,t.length,0,i),o.close(F),o.chmod(d,l)}},createDevice(r,e,t,n){var l;var a=U.join2(typeof r=="string"?r:o.getPath(r),e),i=oe(!!t,!!n);(l=o.createDevice).major??(l.major=64);var s=o.makedev(o.createDevice.major++,0);return o.registerDevice(s,{open(d){d.seekable=!1},close(d){var m;(m=n==null?void 0:n.buffer)!=null&&m.length&&n(10)},read(d,m,w,E,F){for(var b=0,S=0;S<E;S++){var C;try{C=t()}catch{throw new o.ErrnoError(29)}if(C===void 0&&b===0)throw new o.ErrnoError(6);if(C==null)break;b++,m[w+S]=C}return b&&(d.node.timestamp=Date.now()),b},write(d,m,w,E,F){for(var b=0;b<E;b++)try{n(m[w+b])}catch{throw new o.ErrnoError(29)}return E&&(d.node.timestamp=Date.now()),b}}),o.mkdev(a,i,s)},forceLoadFile(r){if(r.isDevice||r.isFolder||r.link||r.contents)return!0;if(typeof XMLHttpRequest<"u")throw new Error("Lazy loading should have been performed (contents set) in createLazyFile, but it was not. Lazy loading only works in web workers. Use --embed-file or --preload-file in emcc on the main thread.");try{r.contents=L(r.url),r.usedBytes=r.contents.length}catch{throw new o.ErrnoError(29)}},createLazyFile(r,e,t,n,a){class i{constructor(){this.lengthKnown=!1,this.chunks=[]}get(b){if(!(b>this.length-1||b<0)){var S=b%this.chunkSize,C=b/this.chunkSize|0;return this.getter(C)[S]}}setDataGetter(b){this.getter=b}cacheLength(){var b=new XMLHttpRequest;if(b.open("HEAD",t,!1),b.send(null),!(b.status>=200&&b.status<300||b.status===304))throw new Error("Couldn't load "+t+". Status: "+b.status);var S=Number(b.getResponseHeader("Content-length")),C,rr=(C=b.getResponseHeader("Accept-Ranges"))&&C==="bytes",H=(C=b.getResponseHeader("Content-Encoding"))&&C==="gzip",sr=1024*1024;rr||(sr=S);var lr=(ur,Mr)=>{if(ur>Mr)throw new Error("invalid range ("+ur+", "+Mr+") or no bytes requested!");if(Mr>S-1)throw new Error("only "+S+" bytes available! programmer error!");var er=new XMLHttpRequest;if(er.open("GET",t,!1),S!==sr&&er.setRequestHeader("Range","bytes="+ur+"-"+Mr),er.responseType="arraybuffer",er.overrideMimeType&&er.overrideMimeType("text/plain; charset=x-user-defined"),er.send(null),!(er.status>=200&&er.status<300||er.status===304))throw new Error("Couldn't load "+t+". Status: "+er.status);return er.response!==void 0?new Uint8Array(er.response||[]):Ue(er.responseText||"")},Rr=this;Rr.setDataGetter(ur=>{var Mr=ur*sr,er=(ur+1)*sr-1;if(er=Math.min(er,S-1),typeof Rr.chunks[ur]>"u"&&(Rr.chunks[ur]=lr(Mr,er)),typeof Rr.chunks[ur]>"u")throw new Error("doXHR failed!");return Rr.chunks[ur]}),(H||!S)&&(sr=S=1,S=this.getter(0).length,sr=S,W("LazyFiles on gzip forces download of the whole file when length is accessed")),this._length=S,this._chunkSize=sr,this.lengthKnown=!0}get length(){return this.lengthKnown||this.cacheLength(),this._length}get chunkSize(){return this.lengthKnown||this.cacheLength(),this._chunkSize}}if(typeof XMLHttpRequest<"u"){if(!I)throw"Cannot do synchronous binary XHRs outside webworkers in modern browsers. Use --embed-file or --preload-file in emcc";var s=new i,l={isDevice:!1,contents:s}}else var l={isDevice:!1,url:t};var d=o.createFile(r,e,l,n,a);l.contents?d.contents=l.contents:l.url&&(d.contents=null,d.url=l.url),Object.defineProperties(d,{usedBytes:{get:function(){return this.contents.length}}});var m={},w=Object.keys(d.stream_ops);w.forEach(F=>{var b=d.stream_ops[F];m[F]=(...S)=>(o.forceLoadFile(d),b(...S))});function E(F,b,S,C,rr){var H=F.node.contents;if(rr>=H.length)return 0;var sr=Math.min(H.length-rr,C);if(H.slice)for(var lr=0;lr<sr;lr++)b[S+lr]=H[rr+lr];else for(var lr=0;lr<sr;lr++)b[S+lr]=H.get(rr+lr);return sr}return m.read=(F,b,S,C,rr)=>(o.forceLoadFile(d),E(F,b,S,C,rr)),m.mmap=(F,b,S,C,rr)=>{o.forceLoadFile(d);var H=Be(b);if(!H)throw new o.ErrnoError(48);return E(F,q,H,b,S),{ptr:H,allocated:!0}},d.stream_ops=m,d}},ae=(r,e)=>r?Fr(Y,r,e):"",j={DEFAULT_POLLMASK:5,calculateAt(r,e,t){if(U.isAbs(e))return e;var n;if(r===-100)n=o.cwd();else{var a=j.getStreamFromFD(r);n=a.path}if(e.length==0){if(!t)throw new o.ErrnoError(44);return n}return U.join2(n,e)},doStat(r,e,t){var n=r(e);A[t>>2]=n.dev,A[t+4>>2]=n.mode,z[t+8>>2]=n.nlink,A[t+12>>2]=n.uid,A[t+16>>2]=n.gid,A[t+20>>2]=n.rdev,X=[n.size>>>0,(P=n.size,+Math.abs(P)>=1?P>0?+Math.floor(P/4294967296)>>>0:~~+Math.ceil((P-+(~~P>>>0))/4294967296)>>>0:0)],A[t+24>>2]=X[0],A[t+28>>2]=X[1],A[t+32>>2]=4096,A[t+36>>2]=n.blocks;var a=n.atime.getTime(),i=n.mtime.getTime(),s=n.ctime.getTime();return X=[Math.floor(a/1e3)>>>0,(P=Math.floor(a/1e3),+Math.abs(P)>=1?P>0?+Math.floor(P/4294967296)>>>0:~~+Math.ceil((P-+(~~P>>>0))/4294967296)>>>0:0)],A[t+40>>2]=X[0],A[t+44>>2]=X[1],z[t+48>>2]=a%1e3*1e3*1e3,X=[Math.floor(i/1e3)>>>0,(P=Math.floor(i/1e3),+Math.abs(P)>=1?P>0?+Math.floor(P/4294967296)>>>0:~~+Math.ceil((P-+(~~P>>>0))/4294967296)>>>0:0)],A[t+56>>2]=X[0],A[t+60>>2]=X[1],z[t+64>>2]=i%1e3*1e3*1e3,X=[Math.floor(s/1e3)>>>0,(P=Math.floor(s/1e3),+Math.abs(P)>=1?P>0?+Math.floor(P/4294967296)>>>0:~~+Math.ceil((P-+(~~P>>>0))/4294967296)>>>0:0)],A[t+72>>2]=X[0],A[t+76>>2]=X[1],z[t+80>>2]=s%1e3*1e3*1e3,X=[n.ino>>>0,(P=n.ino,+Math.abs(P)>=1?P>0?+Math.floor(P/4294967296)>>>0:~~+Math.ceil((P-+(~~P>>>0))/4294967296)>>>0:0)],A[t+88>>2]=X[0],A[t+92>>2]=X[1],0},doMsync(r,e,t,n,a){if(!o.isFile(e.node.mode))throw new o.ErrnoError(43);if(n&2)return 0;var i=Y.slice(r,r+t);o.msync(e,i,a,t,n)},getStreamFromFD(r){var e=o.getStreamChecked(r);return e},varargs:void 0,getStr(r){var e=ae(r);return e}};function an(r,e){try{return r=j.getStr(r),o.chmod(r,e),0}catch(t){if(typeof o>"u"||t.name!=="ErrnoError")throw t;return-t.errno}}function sn(r,e,t,n){try{if(e=j.getStr(e),e=j.calculateAt(r,e),t&-8)return-28;var a=o.lookupPath(e,{follow:!0}),i=a.node;if(!i)return-44;var s="";return t&4&&(s+="r"),t&2&&(s+="w"),t&1&&(s+="x"),s&&o.nodePermissions(i,s)?-2:0}catch(l){if(typeof o>"u"||l.name!=="ErrnoError")throw l;return-l.errno}}function Lr(){var r=A[+j.varargs>>2];return j.varargs+=4,r}var Ar=Lr;function ln(r,e,t){j.varargs=t;try{var n=j.getStreamFromFD(r);switch(e){case 0:{var a=Lr();if(a<0)return-28;for(;o.streams[a];)a++;var i;return i=o.dupStream(n,a),i.fd}case 1:case 2:return 0;case 3:return n.flags;case 4:{var a=Lr();return n.flags|=a,0}case 12:{var a=Ar(),s=0;return ar[a+s>>1]=2,0}case 13:case 14:return 0}return-28}catch(l){if(typeof o>"u"||l.name!=="ErrnoError")throw l;return-l.errno}}function cn(r,e){try{var t=j.getStreamFromFD(r);return j.doStat(o.stat,t.path,e)}catch(n){if(typeof o>"u"||n.name!=="ErrnoError")throw n;return-n.errno}}function un(r,e,t){j.varargs=t;try{var n=j.getStreamFromFD(r);switch(e){case 21509:return n.tty?0:-59;case 21505:{if(!n.tty)return-59;if(n.tty.ops.ioctl_tcgets){var a=n.tty.ops.ioctl_tcgets(n),i=Ar();A[i>>2]=a.c_iflag||0,A[i+4>>2]=a.c_oflag||0,A[i+8>>2]=a.c_cflag||0,A[i+12>>2]=a.c_lflag||0;for(var s=0;s<32;s++)q[i+s+17]=a.c_cc[s]||0;return 0}return 0}case 21510:case 21511:case 21512:return n.tty?0:-59;case 21506:case 21507:case 21508:{if(!n.tty)return-59;if(n.tty.ops.ioctl_tcsets){for(var i=Ar(),l=A[i>>2],d=A[i+4>>2],m=A[i+8>>2],w=A[i+12>>2],E=[],s=0;s<32;s++)E.push(q[i+s+17]);return n.tty.ops.ioctl_tcsets(n.tty,e,{c_iflag:l,c_oflag:d,c_cflag:m,c_lflag:w,c_cc:E})}return 0}case 21519:{if(!n.tty)return-59;var i=Ar();return A[i>>2]=0,0}case 21520:return n.tty?-28:-59;case 21531:{var i=Ar();return o.ioctl(n,e,i)}case 21523:{if(!n.tty)return-59;if(n.tty.ops.ioctl_tiocgwinsz){var F=n.tty.ops.ioctl_tiocgwinsz(n.tty),i=Ar();ar[i>>1]=F[0],ar[i+2>>1]=F[1]}return 0}case 21524:return n.tty?0:-59;case 21515:return n.tty?0:-59;default:return-28}}catch(b){if(typeof o>"u"||b.name!=="ErrnoError")throw b;return-b.errno}}function fn(r,e){try{return r=j.getStr(r),j.doStat(o.lstat,r,e)}catch(t){if(typeof o>"u"||t.name!=="ErrnoError")throw t;return-t.errno}}function dn(r,e,t,n){try{e=j.getStr(e);var a=n&256,i=n&4096;return n=n&-6401,e=j.calculateAt(r,e,i),j.doStat(a?o.lstat:o.stat,e,t)}catch(s){if(typeof o>"u"||s.name!=="ErrnoError")throw s;return-s.errno}}function vn(r,e,t,n){j.varargs=n;try{e=j.getStr(e),e=j.calculateAt(r,e);var a=n?Lr():0;return o.open(e,t,a).fd}catch(i){if(typeof o>"u"||i.name!=="ErrnoError")throw i;return-i.errno}}function hn(r){try{return r=j.getStr(r),o.rmdir(r),0}catch(e){if(typeof o>"u"||e.name!=="ErrnoError")throw e;return-e.errno}}function mn(r,e){try{return r=j.getStr(r),j.doStat(o.stat,r,e)}catch(t){if(typeof o>"u"||t.name!=="ErrnoError")throw t;return-t.errno}}function pn(r,e,t){try{return e=j.getStr(e),e=j.calculateAt(r,e),t===0?o.unlink(e):t===512?o.rmdir(e):Cr("Invalid flags passed to unlinkat"),0}catch(n){if(typeof o>"u"||n.name!=="ErrnoError")throw n;return-n.errno}}var yn=()=>{Cr("")},gn=(r,e,t,n,a)=>{},_n=()=>{for(var r=new Array(256),e=0;e<256;++e)r[e]=String.fromCharCode(e);We=r},We,ir=r=>{for(var e="",t=r;Y[t];)e+=We[Y[t++]];return e},Sr={},wr={},Br={},Ve,nr=r=>{throw new Ve(r)},He,qe=r=>{throw new He(r)},wn=(r,e,t)=>{r.forEach(l=>Br[l]=e);function n(l){var d=t(l);d.length!==r.length&&qe("Mismatched type converter count");for(var m=0;m<r.length;++m)vr(r[m],d[m])}var a=new Array(e.length),i=[],s=0;e.forEach((l,d)=>{wr.hasOwnProperty(l)?a[d]=wr[l]:(i.push(l),Sr.hasOwnProperty(l)||(Sr[l]=[]),Sr[l].push(()=>{a[d]=wr[l],++s,s===i.length&&n(a)}))}),i.length===0&&n(a)};function En(r,e,t={}){var n=e.name;if(r||nr(`type "${n}" must have a positive integer typeid pointer`),wr.hasOwnProperty(r)){if(t.ignoreDuplicateRegistrations)return;nr(`Cannot register type '${n}' twice`)}if(wr[r]=e,delete Br[r],Sr.hasOwnProperty(r)){var a=Sr[r];delete Sr[r],a.forEach(i=>i())}}function vr(r,e,t={}){return En(r,e,t)}var Er=8,bn=(r,e,t,n)=>{e=ir(e),vr(r,{name:e,fromWireType:function(a){return!!a},toWireType:function(a,i){return i?t:n},argPackAdvance:Er,readValueFromPointer:function(a){return this.fromWireType(Y[a])},destructorFunction:null})},ie=[],hr=[],se=r=>{r>9&&--hr[r+1]===0&&(hr[r]=void 0,ie.push(r))},kn=()=>hr.length/2-5-ie.length,Fn=()=>{hr.push(0,1,void 0,1,null,1,!0,1,!1,1),u.count_emval_handles=kn},K={toValue:r=>(r||nr("Cannot use deleted val. handle = "+r),hr[r]),toHandle:r=>{switch(r){case void 0:return 2;case null:return 4;case!0:return 6;case!1:return 8;default:{const e=ie.pop()||hr.length;return hr[e]=r,hr[e+1]=1,e}}}};function le(r){return this.fromWireType(z[r>>2])}var An={name:"emscripten::val",fromWireType:r=>{var e=K.toValue(r);return se(r),e},toWireType:(r,e)=>K.toHandle(e),argPackAdvance:Er,readValueFromPointer:le,destructorFunction:null},Sn=r=>vr(r,An),Tn=(r,e)=>{switch(e){case 4:return function(t){return this.fromWireType(jr[t>>2])};case 8:return function(t){return this.fromWireType(Me[t>>3])};default:throw new TypeError(`invalid float width (${e}): ${r}`)}},Dn=(r,e,t)=>{e=ir(e),vr(r,{name:e,fromWireType:n=>n,toWireType:(n,a)=>a,argPackAdvance:Er,readValueFromPointer:Tn(e,t),destructorFunction:null})},Wr=(r,e)=>Object.defineProperty(e,"name",{value:r}),Ye=r=>{for(;r.length;){var e=r.pop(),t=r.pop();t(e)}};function Ge(r){for(var e=1;e<r.length;++e)if(r[e]!==null&&r[e].destructorFunction===void 0)return!0;return!1}function Xe(r,e){if(!(r instanceof Function))throw new TypeError(`new_ called with constructor type ${typeof r} which is not a function`);var t=Wr(r.name||"unknownFunctionName",function(){});t.prototype=r.prototype;var n=new t,a=r.apply(n,e);return a instanceof Object?a:n}function Mn(r,e,t,n){for(var a=Ge(r),i=r.length-2,s=[],l=["fn"],d=0;d<i;++d)s.push(`arg${d}`),l.push(`arg${d}Wired`);s=s.join(","),l=l.join(",");var m=`return function (${s}) {
`;a&&(m+=`var destructors = [];
`);for(var w=a?"destructors":"null",E=["humanName","throwBindingError","invoker","fn","runDestructors","retType","classParam"],d=0;d<i;++d)m+=`var arg${d}Wired = argType${d}['toWireType'](${w}, arg${d});
`,E.push(`argType${d}`);if(m+=(t||n?"var rv = ":"")+`invoker(${l});
`,a)m+=`runDestructors(destructors);
`;else for(var d=2;d<r.length;++d){var F=d===1?"thisWired":"arg"+(d-2)+"Wired";r[d].destructorFunction!==null&&(m+=`${F}_dtor(${F});
`,E.push(`${F}_dtor`))}return t&&(m+=`var ret = retType['fromWireType'](rv);
return ret;
`),m+=`}
`,[E,m]}function Pn(r,e,t,n,a,i){var s=e.length;s<2&&nr("argTypes array size mismatch! Must at least get return value and 'this' types!");for(var l=e[1]!==null&&t!==null,d=Ge(e),m=e[0].name!=="void",w=[r,nr,n,a,Ye,e[0],e[1]],E=0;E<s-2;++E)w.push(e[E+2]);if(!d)for(var E=2;E<e.length;++E)e[E].destructorFunction!==null&&w.push(e[E].destructorFunction);let[F,b]=Mn(e,l,m,i);F.push(b);var S=Xe(Function,F)(...w);return Wr(r,S)}var Cn=(r,e,t)=>{if(r[e].overloadTable===void 0){var n=r[e];r[e]=function(...a){return r[e].overloadTable.hasOwnProperty(a.length)||nr(`Function '${t}' called with an invalid number of arguments (${a.length}) - expects one of (${r[e].overloadTable})!`),r[e].overloadTable[a.length].apply(this,a)},r[e].overloadTable=[],r[e].overloadTable[n.argCount]=n}},In=(r,e,t)=>{u.hasOwnProperty(r)?((t===void 0||u[r].overloadTable!==void 0&&u[r].overloadTable[t]!==void 0)&&nr(`Cannot register public name '${r}' twice`),Cn(u,r,r),u.hasOwnProperty(t)&&nr(`Cannot register multiple overloads of a function with the same number of arguments (${t})!`),u[r].overloadTable[t]=e):(u[r]=e,t!==void 0&&(u[r].numArguments=t))},Rn=(r,e)=>{for(var t=[],n=0;n<r;n++)t.push(z[e+n*4>>2]);return t},Nn=(r,e,t)=>{u.hasOwnProperty(r)||qe("Replacing nonexistent public symbol"),u[r].overloadTable!==void 0&&t!==void 0?u[r].overloadTable[t]=e:(u[r]=e,u[r].argCount=t)},xn=(r,e,t)=>{r=r.replace(/p/g,"i");var n=u["dynCall_"+r];return n(e,...t)},Vr=[],Ke,Je=r=>{var e=Vr[r];return e||(r>=Vr.length&&(Vr.length=r+1),Vr[r]=e=Ke.get(r)),e},On=(r,e,t=[])=>{if(r.includes("j"))return xn(r,e,t);var n=Je(e)(...t);return n},jn=(r,e)=>(...t)=>On(r,e,t),$n=(r,e)=>{r=ir(r);function t(){return r.includes("j")?jn(r,e):Je(e)}var n=t();return typeof n!="function"&&nr(`unknown function pointer with signature ${r}: ${e}`),n},zn=(r,e)=>{var t=Wr(e,function(n){this.name=e,this.message=n;var a=new Error(n).stack;a!==void 0&&(this.stack=this.toString()+`
`+a.replace(/^Error(:[^\n]*)?\n/,""))});return t.prototype=Object.create(r.prototype),t.prototype.constructor=t,t.prototype.toString=function(){return this.message===void 0?this.name:`${this.name}: ${this.message}`},t},Ze,Qe=r=>{var e=at(r),t=ir(e);return mr(e),t},Un=(r,e)=>{var t=[],n={};function a(i){if(!n[i]&&!wr[i]){if(Br[i]){Br[i].forEach(a);return}t.push(i),n[i]=!0}}throw e.forEach(a),new Ze(`${r}: `+t.map(Qe).join([", "]))},Ln=r=>{r=r.trim();const e=r.indexOf("(");return e!==-1?r.substr(0,e):r},Bn=(r,e,t,n,a,i,s,l)=>{var d=Rn(e,t);r=ir(r),r=Ln(r),a=$n(n,a),In(r,function(){Un(`Cannot call ${r} due to unbound types`,d)},e-1),wn([],d,m=>{var w=[m[0],null].concat(m.slice(1));return Nn(r,Pn(r,w,null,a,i,s),e-1),[]})},Wn=(r,e,t)=>{switch(e){case 1:return t?n=>q[n]:n=>Y[n];case 2:return t?n=>ar[n>>1]:n=>kr[n>>1];case 4:return t?n=>A[n>>2]:n=>z[n>>2];default:throw new TypeError(`invalid integer width (${e}): ${r}`)}},Vn=(r,e,t,n,a)=>{e=ir(e);var i=w=>w;if(n===0){var s=32-8*t;i=w=>w<<s>>>s}var l=e.includes("unsigned"),d=(w,E)=>{},m;l?m=function(w,E){return d(E,this.name),E>>>0}:m=function(w,E){return d(E,this.name),E},vr(r,{name:e,fromWireType:i,toWireType:m,argPackAdvance:Er,readValueFromPointer:Wn(e,t,n!==0),destructorFunction:null})},Hn=(r,e,t)=>{var n=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],a=n[e];function i(s){var l=z[s>>2],d=z[s+4>>2];return new a(q.buffer,d,l)}t=ir(t),vr(r,{name:t,fromWireType:i,argPackAdvance:Er,readValueFromPointer:i},{ignoreDuplicateRegistrations:!0})},Tr=(r,e,t)=>ne(r,Y,e,t),qn=(r,e)=>{e=ir(e);var t=e==="std::string";vr(r,{name:e,fromWireType(n){var a=z[n>>2],i=n+4,s;if(t)for(var l=i,d=0;d<=a;++d){var m=i+d;if(d==a||Y[m]==0){var w=m-l,E=ae(l,w);s===void 0?s=E:(s+="\0",s+=E),l=m+1}}else{for(var F=new Array(a),d=0;d<a;++d)F[d]=String.fromCharCode(Y[i+d]);s=F.join("")}return mr(n),s},toWireType(n,a){a instanceof ArrayBuffer&&(a=new Uint8Array(a));var i,s=typeof a=="string";s||a instanceof Uint8Array||a instanceof Uint8ClampedArray||a instanceof Int8Array||nr("Cannot pass non-string to std::string"),t&&s?i=Ur(a):i=a.length;var l=he(4+i+1),d=l+4;if(z[l>>2]=i,t&&s)Tr(a,d,i+1);else if(s)for(var m=0;m<i;++m){var w=a.charCodeAt(m);w>255&&(mr(d),nr("String has UTF-16 code units that do not fit in 8 bits")),Y[d+m]=w}else for(var m=0;m<i;++m)Y[d+m]=a[m];return n!==null&&n.push(mr,l),l},argPackAdvance:Er,readValueFromPointer:le,destructorFunction(n){mr(n)}})},rt=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0,Yn=(r,e)=>{for(var t=r,n=t>>1,a=n+e/2;!(n>=a)&&kr[n];)++n;if(t=n<<1,t-r>32&&rt)return rt.decode(Y.subarray(r,t));for(var i="",s=0;!(s>=e/2);++s){var l=ar[r+s*2>>1];if(l==0)break;i+=String.fromCharCode(l)}return i},Gn=(r,e,t)=>{if(t??(t=2147483647),t<2)return 0;t-=2;for(var n=e,a=t<r.length*2?t/2:r.length,i=0;i<a;++i){var s=r.charCodeAt(i);ar[e>>1]=s,e+=2}return ar[e>>1]=0,e-n},Xn=r=>r.length*2,Kn=(r,e)=>{for(var t=0,n="";!(t>=e/4);){var a=A[r+t*4>>2];if(a==0)break;if(++t,a>=65536){var i=a-65536;n+=String.fromCharCode(55296|i>>10,56320|i&1023)}else n+=String.fromCharCode(a)}return n},Jn=(r,e,t)=>{if(t??(t=2147483647),t<4)return 0;for(var n=e,a=n+t-4,i=0;i<r.length;++i){var s=r.charCodeAt(i);if(s>=55296&&s<=57343){var l=r.charCodeAt(++i);s=65536+((s&1023)<<10)|l&1023}if(A[e>>2]=s,e+=4,e+4>a)break}return A[e>>2]=0,e-n},Zn=r=>{for(var e=0,t=0;t<r.length;++t){var n=r.charCodeAt(t);n>=55296&&n<=57343&&++t,e+=4}return e},Qn=(r,e,t)=>{t=ir(t);var n,a,i,s;e===2?(n=Yn,a=Gn,s=Xn,i=l=>kr[l>>1]):e===4&&(n=Kn,a=Jn,s=Zn,i=l=>z[l>>2]),vr(r,{name:t,fromWireType:l=>{for(var d=z[l>>2],m,w=l+4,E=0;E<=d;++E){var F=l+4+E*e;if(E==d||i(F)==0){var b=F-w,S=n(w,b);m===void 0?m=S:(m+="\0",m+=S),w=F+e}}return mr(l),m},toWireType:(l,d)=>{typeof d!="string"&&nr(`Cannot pass non-string to C++ string type ${t}`);var m=s(d),w=he(4+m+e);return z[w>>2]=m/e,a(d,w+4,m+e),l!==null&&l.push(mr,w),w},argPackAdvance:Er,readValueFromPointer:le,destructorFunction(l){mr(l)}})},ro=(r,e)=>{e=ir(e),vr(r,{isVoid:!0,name:e,argPackAdvance:0,fromWireType:()=>{},toWireType:(t,n)=>{}})},eo=1,to=()=>eo,et=r=>{for(var e=r.split("."),t=0;t<4;t++){var n=Number(e[t]);if(isNaN(n))return null;e[t]=n}return(e[0]|e[1]<<8|e[2]<<16|e[3]<<24)>>>0},Hr=r=>parseInt(r),no=r=>{var e,t,n,a,i=/^((?=.*::)(?!.*::.+::)(::)?([\dA-F]{1,4}:(:|\b)|){5}|([\dA-F]{1,4}:){6})((([\dA-F]{1,4}((?!\3)::|:\b|$))|(?!\2\3)){2}|(((2[0-4]|1\d|[1-9])?\d|25[0-5])\.?\b){4})$/i,s=[];if(!i.test(r))return null;if(r==="::")return[0,0,0,0,0,0,0,0];for(r.startsWith("::")?r=r.replace("::","Z:"):r=r.replace("::",":Z:"),r.indexOf(".")>0?(r=r.replace(new RegExp("[.]","g"),":"),e=r.split(":"),e[e.length-4]=Hr(e[e.length-4])+Hr(e[e.length-3])*256,e[e.length-3]=Hr(e[e.length-2])+Hr(e[e.length-1])*256,e=e.slice(0,e.length-2)):e=r.split(":"),n=0,a=0,t=0;t<e.length;t++)if(typeof e[t]=="string")if(e[t]==="Z"){for(a=0;a<8-e.length+1;a++)s[t+a]=0;n=a-1}else s[t+n]=it(parseInt(e[t],16));else s[t+n]=e[t];return[s[1]<<16|s[0],s[3]<<16|s[2],s[5]<<16|s[4],s[7]<<16|s[6]]},pr={address_map:{id:1,addrs:{},names:{}},lookup_name(r){var e=et(r);if(e!==null||(e=no(r),e!==null))return r;var t;if(pr.address_map.addrs[r])t=pr.address_map.addrs[r];else{var n=pr.address_map.id++;yr(n<65535,"exceeded max address mappings of 65535"),t="172.29."+(n&255)+"."+(n&65280),pr.address_map.names[t]=r,pr.address_map.addrs[r]=t}return t},lookup_addr(r){return pr.address_map.names[r]?pr.address_map.names[r]:null}},oo=r=>{var e=ae(r);return et(pr.lookup_name(e))},ao=(r,e,t)=>Y.copyWithin(r,e,e+t),ce=(r,e)=>{var t=wr[r];return t===void 0&&nr(`${e} has unknown type ${Qe(r)}`),t},tt=(r,e,t)=>{var n=[],a=r.toWireType(n,t);return n.length&&(z[e>>2]=K.toHandle(n)),a},io=(r,e,t)=>(r=K.toValue(r),e=ce(e,"emval::as"),tt(e,t,r)),so={},ue=r=>{var e=so[r];return e===void 0?ir(r):e},fe=[],lo=(r,e,t,n,a)=>(r=fe[r],e=K.toValue(e),t=ue(t),r(e,e[t],n,a)),nt=()=>typeof globalThis=="object"?globalThis:(function(){return Function})()("return this")(),co=r=>r===0?K.toHandle(nt()):(r=ue(r),K.toHandle(nt()[r])),uo=r=>{var e=fe.length;return fe.push(r),e},fo=(r,e)=>{for(var t=new Array(r),n=0;n<r;++n)t[n]=ce(z[e+n*4>>2],"parameter "+n);return t},vo=(r,e,t)=>{var n=fo(r,e),a=n.shift();r--;var i=`return function (obj, func, destructorsRef, args) {
`,s=0,l=[];t===0&&l.push("obj");for(var d=["retType"],m=[a],w=0;w<r;++w)l.push("arg"+w),d.push("argType"+w),m.push(n[w]),i+=`  var arg${w} = argType${w}.readValueFromPointer(args${s?"+"+s:""});
`,s+=n[w].argPackAdvance;var E=t===1?"new func":"func.call";i+=`  var rv = ${E}(${l.join(", ")});
`,a.isVoid||(d.push("emval_returnValue"),m.push(tt),i+=`  return emval_returnValue(retType, destructorsRef, rv);
`),i+=`};
`,d.push(i);var F=Xe(Function,d)(...m),b=`methodCaller<(${n.map(S=>S.name).join(", ")}) => ${a.name}>`;return uo(Wr(b,F))},ho=(r,e)=>(r=K.toValue(r),e=K.toValue(e),K.toHandle(r[e])),mo=r=>{r>9&&(hr[r+1]+=1)},po=()=>K.toHandle([]),yo=r=>K.toHandle(ue(r)),go=()=>K.toHandle({}),_o=r=>{var e=K.toValue(r);Ye(e),se(r)},wo=(r,e,t)=>{r=K.toValue(r),e=K.toValue(e),t=K.toValue(t),r[e]=t},Eo=(r,e)=>{r=ce(r,"_emval_take_value");var t=r.readValueFromPointer(e);return K.toHandle(t)},bo=r=>r%4===0&&(r%100!==0||r%400===0),ko=[0,31,60,91,121,152,182,213,244,274,305,335],Fo=[0,31,59,90,120,151,181,212,243,273,304,334],Ao=r=>{var e=bo(r.getFullYear()),t=e?ko:Fo,n=t[r.getMonth()]+r.getDate()-1;return n},de=(r,e)=>e+2097152>>>0<4194305-!!r?(r>>>0)+e*4294967296:NaN;function So(r,e,t){var n=de(r,e),a=new Date(n*1e3);A[t>>2]=a.getSeconds(),A[t+4>>2]=a.getMinutes(),A[t+8>>2]=a.getHours(),A[t+12>>2]=a.getDate(),A[t+16>>2]=a.getMonth(),A[t+20>>2]=a.getFullYear()-1900,A[t+24>>2]=a.getDay();var i=Ao(a)|0;A[t+28>>2]=i,A[t+36>>2]=-(a.getTimezoneOffset()*60);var s=new Date(a.getFullYear(),0,1),l=new Date(a.getFullYear(),6,1).getTimezoneOffset(),d=s.getTimezoneOffset(),m=(l!=d&&a.getTimezoneOffset()==Math.min(d,l))|0;A[t+32>>2]=m}function To(r,e,t,n,a,i,s){var l=de(i,s);try{var d=j.getStreamFromFD(a);t&2&&j.doMsync(r,d,e,n,l)}catch(m){if(typeof o>"u"||m.name!=="ErrnoError")throw m;return-m.errno}}var Do=(r,e,t,n)=>{var a=new Date().getFullYear(),i=new Date(a,0,1),s=new Date(a,6,1),l=i.getTimezoneOffset(),d=s.getTimezoneOffset(),m=Math.max(l,d);z[r>>2]=m*60,A[e>>2]=+(l!=d);var w=b=>{var S=b>=0?"-":"+",C=Math.abs(b),rr=String(Math.floor(C/60)).padStart(2,"0"),H=String(C%60).padStart(2,"0");return`UTC${S}${rr}${H}`},E=w(l),F=w(d);d<l?(Tr(E,t,17),Tr(F,n,17)):(Tr(E,n,17),Tr(F,t,17))},Mo=()=>Date.now();function Po(){return new Error().stack.toString()}var Dr=r=>{Dr.shown||(Dr.shown={}),Dr.shown[r]||(Dr.shown[r]=1,T&&(r="warning: "+r),Z(r))};function Co(r){var e=Po(),t=e.lastIndexOf("_emscripten_log"),n=e.lastIndexOf("_emscripten_get_callstack"),a=e.indexOf(`
`,Math.max(t,n))+1;e=e.slice(a),r&8&&typeof emscripten_source_map>"u"&&(Dr('Source map information is not available, emscripten_log with EM_LOG_C_STACK will be ignored. Build with "--pre-js $EMSCRIPTEN/src/emscripten-source-map.min.js" linker flag to add source map loading to code.'),r^=8,r|=16);var i=e.split(`
`);e="";var s=new RegExp("\\s*(.*?)@(.*?):([0-9]+):([0-9]+)"),l=new RegExp("\\s*(.*?)@(.*):(.*)(:(.*))?"),d=new RegExp("\\s*at (.*?) \\((.*):(.*):(.*)\\)");for(var m in i){var w=i[m],E="",F="",b=0,S=0,C=d.exec(w);if(C&&C.length==5)E=C[1],F=C[2],b=C[3],S=C[4];else if(C=s.exec(w)||l.exec(w),C&&C.length>=4)E=C[1],F=C[2],b=C[3],S=C[4]|0;else{e+=w+`
`;continue}var rr=!1;if(r&8){var H=emscripten_source_map.originalPositionFor({line:b,column:S});rr=H==null?void 0:H.source,rr&&(r&64&&(H.source=H.source.substring(H.source.replace(/\\/g,"/").lastIndexOf("/")+1)),e+=`    at ${E} (${H.source}:${H.line}:${H.column})
`)}(r&16||!rr)&&(r&64&&(F=F.substring(F.replace(/\\/g,"/").lastIndexOf("/")+1)),e+=(rr?`     = ${E}`:`    at ${E}`)+` (${F}:${b}:${S})
`)}return e=e.replace(/\s+$/,""),e}function Io(r,e,t){var n=Co(r);if(!e||t<=0)return Ur(n)+1;var a=Tr(n,e,t);return a+1}var ot=()=>2147483648,Ro=()=>ot(),No=r=>{var e=tr.buffer,t=(r-e.byteLength+65535)/65536|0;try{return tr.grow(t),Pe(),1}catch{}},xo=r=>{var e=Y.length;r>>>=0;var t=ot();if(r>t)return!1;for(var n=1;n<=4;n*=2){var a=e*(1+.2/n);a=Math.min(a,r+100663296);var i=Math.min(t,Le(Math.max(r,a),65536)),s=No(i);if(s)return!0}return!1},ve={},Oo=()=>O||"./this.program",Ir=()=>{if(!Ir.strings){var r=(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",e={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:r,_:Oo()};for(var t in ve)ve[t]===void 0?delete e[t]:e[t]=ve[t];var n=[];for(var t in e)n.push(`${t}=${e[t]}`);Ir.strings=n}return Ir.strings},jo=(r,e)=>{for(var t=0;t<r.length;++t)q[e++]=r.charCodeAt(t);q[e]=0},$o=(r,e)=>{var t=0;return Ir().forEach((n,a)=>{var i=e+t;z[r+a*4>>2]=i,jo(n,i),t+=n.length+1}),0},zo=(r,e)=>{var t=Ir();z[r>>2]=t.length;var n=0;return t.forEach(a=>n+=a.length+1),z[e>>2]=n,0},Uo=r=>{B(r,new Xt(r))},Lo=(r,e)=>{Uo(r)},Bo=Lo;function Wo(r){try{var e=j.getStreamFromFD(r);return o.close(e),0}catch(t){if(typeof o>"u"||t.name!=="ErrnoError")throw t;return t.errno}}var Vo=(r,e,t,n)=>{for(var a=0,i=0;i<t;i++){var s=z[e>>2],l=z[e+4>>2];e+=8;var d=o.read(r,q,s,l,n);if(d<0)return-1;if(a+=d,d<l)break}return a};function Ho(r,e,t,n){try{var a=j.getStreamFromFD(r),i=Vo(a,e,t);return z[n>>2]=i,0}catch(s){if(typeof o>"u"||s.name!=="ErrnoError")throw s;return s.errno}}function qo(r,e,t,n,a){var i=de(e,t);try{if(isNaN(i))return 61;var s=j.getStreamFromFD(r);return o.llseek(s,i,n),X=[s.position>>>0,(P=s.position,+Math.abs(P)>=1?P>0?+Math.floor(P/4294967296)>>>0:~~+Math.ceil((P-+(~~P>>>0))/4294967296)>>>0:0)],A[a>>2]=X[0],A[a+4>>2]=X[1],s.getdents&&i===0&&n===0&&(s.getdents=null),0}catch(l){if(typeof o>"u"||l.name!=="ErrnoError")throw l;return l.errno}}var Yo=(r,e,t,n)=>{for(var a=0,i=0;i<t;i++){var s=z[e>>2],l=z[e+4>>2];e+=8;var d=o.write(r,q,s,l,n);if(d<0)return-1;if(a+=d,d<l)break}return a};function Go(r,e,t,n){try{var a=j.getStreamFromFD(r),i=Yo(a,e,t);return z[n>>2]=i,0}catch(s){if(typeof o>"u"||s.name!=="ErrnoError")throw s;return s.errno}}o.createPreloadedFile=nn,o.staticInit(),_n(),Ve=u.BindingError=class extends Error{constructor(e){super(e),this.name="BindingError"}},He=u.InternalError=class extends Error{constructor(e){super(e),this.name="InternalError"}},Fn(),Ze=u.UnboundTypeError=zn(Error,"UnboundTypeError");var Xo={M:an,N:sn,h:ln,I:cn,Q:un,F:fn,G:dn,j:vn,B:hn,H:mn,C:pn,A:yn,w:gn,V:bn,U:Sn,n:Dn,f:Bn,b:Vn,a:Hn,m:qn,i:Qn,W:ro,J:to,x:oo,L:ao,e:io,q:lo,T:se,u:co,p:vo,k:ho,Y:mo,X:po,r:yo,Z:go,o:_o,c:wo,d:Eo,t:So,s:To,O:Do,K:Mo,R:Io,z:Ro,y:xo,D:$o,E:zo,S:Bo,g:Wo,P:Ho,v:qo,l:Go},Q=Gt(),at=r=>(at=Q.aa)(r),he=r=>(he=Q.ca)(r),mr=r=>(mr=Q.da)(r),it=r=>(it=Q.ea)(r),st=(r,e)=>(st=Q.fa)(r,e),lt=()=>(lt=Q.ga)();u.dynCall_viijii=(r,e,t,n,a,i,s)=>(u.dynCall_viijii=Q.ha)(r,e,t,n,a,i,s),u.dynCall_viiiiji=(r,e,t,n,a,i,s,l)=>(u.dynCall_viiiiji=Q.ia)(r,e,t,n,a,i,s,l),u.dynCall_jiji=(r,e,t,n,a)=>(u.dynCall_jiji=Q.ja)(r,e,t,n,a),u.dynCall_iiiiij=(r,e,t,n,a,i,s)=>(u.dynCall_iiiiij=Q.ka)(r,e,t,n,a,i,s),u.dynCall_iiiiijj=(r,e,t,n,a,i,s,l,d)=>(u.dynCall_iiiiijj=Q.la)(r,e,t,n,a,i,s,l,d),u.dynCall_iiiiiijj=(r,e,t,n,a,i,s,l,d,m)=>(u.dynCall_iiiiiijj=Q.ma)(r,e,t,n,a,i,s,l,d,m);var qr,ct;Pr=function r(){qr||ut(),qr||(Pr=r)};function ut(){if(gr>0||!ct&&(ct=1,jt(),gr>0))return;function r(){var e;qr||(qr=1,u.calledRun=1,!cr&&($t(),k(u),(e=u.onRuntimeInitialized)==null||e.call(u),zt()))}u.setStatus?(u.setStatus("Running..."),setTimeout(()=>{setTimeout(()=>u.setStatus(""),1),r()},1)):r()}if(u.preInit)for(typeof u.preInit=="function"&&(u.preInit=[u.preInit]);u.preInit.length>0;)u.preInit.pop()();return ut(),f=R,f})})();c.exports=h})(Yr)),Yr.exports}var yt=pt(),gt=dt(yt);const br=(c,v,h)=>Math.min(Math.max(c,v),h),pe=(c,v)=>{const h=Number(c);return Number.isFinite(h)?h:v},ye=(c,v,h)=>c+(v-c)*h,_t=c=>{const v=c.length/3;if(v<6)return null;let h=0,p=1,g=0;for(let x=0;x<v;x+=1)for(let W=x+1;W<v;W+=1){const Z=c[x*3]-c[W*3],or=c[x*3+1]-c[W*3+1],tr=c[x*3+2]-c[W*3+2],cr=Z*Z+or*or+tr*tr;cr>g&&(g=cr,h=x,p=W)}const y=c[h*3],f=c[h*3+1],u=c[h*3+2],k=c[p*3],_=c[p*3+1],R=c[p*3+2];let $=k-y,I=_-f,T=R-u;const M=Math.hypot($,I,T);if(M===0)return null;$/=M,I/=M,T/=M;const O=[],B=[];for(let x=0;x<v;x+=1){const W=c[x*3],Z=c[x*3+1],or=c[x*3+2],tr=W-y,cr=Z-f,yr=or-u,q=tr*$+cr*I+yr*T;B.push(q);const Y=y+$*q,ar=f+I*q,kr=u+T*q,A=W-Y,z=Z-ar,jr=or-kr;O.push(Math.hypot(A,z,jr))}const N=B.reduce((x,W)=>x+W,0)/B.length,G=[y+$*N,f+I*N,u+T*N],V=O.reduce((x,W)=>x+W,0)/O.length,L=O.reduce((x,W)=>x+(W-V)*(W-V),0)/O.length,J=Math.sqrt(L);return{axis:[$,I,T],center:G,meanRadius:V,stdRadius:J}},wt=c=>{const v=c.length/3;if(!v)return[0,0,0];let h=0,p=0,g=0;for(let y=0;y<c.length;y+=3)h+=c[y],p+=c[y+1],g+=c[y+2];return[h/v,p/v,g/v]},Et=(c,v)=>{const h=[0,0,0],p=(y,f,u)=>{const k=c[y*3],_=c[y*3+1],R=c[y*3+2],$=c[f*3],I=c[f*3+1],T=c[f*3+2],M=c[u*3],O=c[u*3+1],B=c[u*3+2],N=$-k,G=I-_,V=T-R,L=M-k,J=O-_,x=B-R;h[0]+=G*x-V*J,h[1]+=V*L-N*x,h[2]+=N*J-G*L};if(v&&v.length>=3)for(let y=0;y<v.length;y+=3)p(v[y],v[y+1],v[y+2]);else{const y=Math.floor(c.length/9);for(let f=0;f<y;f+=1)p(f*3,f*3+1,f*3+2)}const g=Math.hypot(h[0],h[1],h[2]);return!g||g<1e-8?[0,0,1]:[h[0]/g,h[1]/g,h[2]/g]},bt=c=>{const v=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],h=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(let p=0;p<c.length;p+=3){const g=c[p],y=c[p+1],f=c[p+2];g<v[0]&&(v[0]=g),y<v[1]&&(v[1]=y),f<v[2]&&(v[2]=f),g>h[0]&&(h[0]=g),y>h[1]&&(h[1]=y),f>h[2]&&(h[2]=f)}return{min:v,max:h,size:[h[0]-v[0],h[1]-v[1],h[2]-v[2]]}},kt=(c,v,h)=>{let p=0;for(let g=0;g<c.length;g+=3){const y=c[g]-v[0],f=c[g+1]-v[1],u=c[g+2]-v[2],k=Math.abs(y*h[0]+f*h[1]+u*h[2]);k>p&&(p=k)}return p},Ft=c=>{let v=0;return c.forEach(h=>{if(h&&h.geometryType==="face"){const p=h.metadata||h.faceData;p&&p.type==="CYLINDER"&&(v+=1)}}),v},At=c=>{let v=0;return c.forEach(h=>{if(!h||h.geometryType!=="solid"||!h.geometry)return;const p=h.geometry.indices,g=h.geometry.positions;p&&p.length?v+=Math.floor(p.length/3):v+=Math.floor(g.length/9)}),v},St=(c,v,h)=>{const p=wt(v),g=Et(v,h),y=bt(v),f=Math.max(y.size[0],y.size[1],y.size[2]),u=Math.max(1e-5,f*.001),k=kt(v,p,g),_={id:c,type:"UNKNOWN",params:{center:p,normal:g}};if(k<=u)return _.type="PLANE",_;const R=_t(v);return R&&R.meanRadius>1e-6&&R.stdRadius/R.meanRadius<.05&&(_.type="CYLINDER",_.params.radius=R.meanRadius,_.params.axis=R.axis,_.params.center=R.center),_},Nr={value:0},fr=c=>c?c instanceof Float32Array?c:new Float32Array(c):new Float32Array,Xr=c=>{if(c)return c instanceof Uint32Array?c:new Uint32Array(c)},xr=c=>{if(!Array.isArray(c)||c.length<3)return[.6,.6,.6];const v=c.slice(0,3).map(Number);return Math.max(v[0],v[1],v[2])>1?[v[0]/255,v[1]/255,v[2]/255]:[v[0],v[1],v[2]]},Kr=(...c)=>{for(const v of c)if(v&&typeof v=="object")return{...v}},Tt=(c,v)=>c&&c.length?Math.floor(c.length/3):Math.floor(v.length/9),Dt=c=>(Nr.value+=1,(c||"face")+"_"+Nr.value),Mt=(c,v)=>c&&Array.isArray(c.brep_faces)&&c.brep_faces.length>0?c.brep_faces.map(h=>({first:typeof h.first=="number"?h.first:0,last:typeof h.last=="number"?h.last:v-1,color:h.color})):[{first:0,last:Math.max(v-1,0),color:c?c.color:void 0}],Pt=(c,v,h,p,g)=>{const y=!!h&&h.length>0,f=new Map,u=[],k=[],_=[],R=T=>{let M=f.get(T);M===void 0&&(M=f.size,f.set(T,M),u.push(c[T*3],c[T*3+1],c[T*3+2]),v&&v.length>=(T+1)*3&&k.push(v[T*3],v[T*3+1],v[T*3+2])),_.push(M)},$=Math.max(0,p),I=Math.max($,g);for(let T=$;T<=I;T+=1){const M=T*3,O=y?h[M]:M,B=y?h[M+1]:M+1,N=y?h[M+2]:M+2;R(O),R(B),R(N)}return{positions:fr(u),normals:fr(k),indices:_.length?new Uint32Array(_):void 0}},ge=(c,v)=>{const h=new Map,p=(y,f)=>{const u=y<f?y+"_"+f:f+"_"+y;h.has(u)||h.set(u,[y,f])};if(v&&v.length>=3)for(let y=0;y<v.length;y+=3){const f=v[y],u=v[y+1],k=v[y+2];p(f,u),p(u,k),p(k,f)}else{const y=Math.floor(c.length/9);for(let f=0;f<y;f+=1){const u=f*3;p(u,u+1),p(u+1,u+2),p(u+2,u)}}const g=[];return h.forEach(([y,f])=>{g.push(c[y*3],c[y*3+1],c[y*3+2],c[f*3],c[f*3+1],c[f*3+2])}),fr(g)},Ct=(c,v,h)=>{var T,M,O;const p=h&&h.positions||c.positions||c.vertices||c.vertexPositions||c.points||((T=c.triangulation)==null?void 0:T.positions)||(c.attributes&&c.attributes.position?c.attributes.position.array:null),g=h&&h.normals||c.normals||c.vertexNormals||c.normalVectors||((M=c.triangulation)==null?void 0:M.normals)||(c.attributes&&c.attributes.normal?c.attributes.normal.array:null),y=h&&h.indices||c.indices||c.triangles||c.indexes||((O=c.triangulation)==null?void 0:O.indices)||(c.index?c.index.array:null),f=fr(p),u=fr(g),k=Xr(y);if(!f.length)return{faceMeshes:[],faceIds:[]};const _=Tt(k,f);if(_<=0)return{faceMeshes:[],faceIds:[]};const R=Mt(c,_),$=[],I=[];return R.forEach((B,N)=>{const G=Math.max(0,typeof B.first=="number"?B.first:0),V=Math.min(typeof B.last=="number"?B.last:_-1,Math.max(_-1,0));if(V<G)return;const L=Pt(f,u,k,G,V);if(!L.positions.length)return;const J=Dt(v+"_face"),x=St(J,L.positions,L.indices),W=ge(L.positions,L.indices);$.push({id:J,name:(c.name||v)+"::face_"+N,color:xr(B.color||h.color||c.color),position:c.position||[0,0,0],rotation:c.rotation||[0,0,0],scale:c.scale||[1,1,1],visible:!0,parentMeshId:v,geometryType:"face",geometry:{positions:L.positions,normals:L.normals,indices:L.indices},edges:W.length?{positions:W}:void 0,metadata:x,faceData:x}),I.push(J)}),{faceMeshes:$,faceIds:I}},_e=(c,v)=>typeof c=="string"?c:typeof c=="number"&&v[c]?v[c]:null,we=c=>Array.isArray(c)?c:c&&Array.isArray(c.meshes)?c.meshes:[],It=c=>{const v=[],h={},p={},g={},y=we(c);return Nr.value=0,y.forEach((f,u)=>{if(!f)return;const k=f.id||f.meshId||f.name||"",_="mesh_"+u;h[u]=_,p[u]=f.name||k||_,g[u]=k||p[u]}),y.forEach((f,u)=>{var N,G,V;if(!f)return;const k=h[u]||"mesh_"+u,_=p[u]||f.name||k,R=g[u]||_,$=f.positions||f.vertices||f.vertexPositions||f.points||((N=f.triangulation)==null?void 0:N.positions)||(f.attributes&&f.attributes.position?f.attributes.position.array:null),I=f.normals||f.vertexNormals||f.normalVectors||((G=f.triangulation)==null?void 0:G.normals)||(f.attributes&&f.attributes.normal?f.attributes.normal.array:null),T=f.indices||f.triangles||f.indexes||((V=f.triangulation)==null?void 0:V.indices)||(f.index?f.index.array:null),M=fr($),O=fr(I),B=Xr(T);if(!M.length){console.warn("Skipping mesh without positions:",k,f),delete h[u];return}v.push({id:k,name:_,definitionId:R,sourceMeshIndex:u,color:xr(f.color),position:f.position||[0,0,0],rotation:f.rotation||[0,0,0],scale:f.scale||[1,1,1],visible:!0,properties:Kr(f.properties,f.metadata,f.userData),geometry:{positions:M,normals:O,indices:B},isSolid:!0,geometryType:"solid"})}),{meshes:v,meshIndexToId:h,meshIndexToName:p}},Ee=c=>{const v=[],h={},p={},g={},y=we(c);return Nr.value=0,y.forEach((f,u)=>{if(!f)return;const k=f.id||f.meshId||f.name||"",_="mesh_"+u;h[u]=_,p[u]=f.name||k||_,g[u]=k||p[u]}),y.forEach((f,u)=>{var V,L,J;if(!f)return;const k=h[u]||"mesh_"+u,_=p[u]||f.name||k,R=g[u]||_,$=f.positions||f.vertices||f.vertexPositions||f.points||((V=f.triangulation)==null?void 0:V.positions)||(f.attributes&&f.attributes.position?f.attributes.position.array:null),I=f.normals||f.vertexNormals||f.normalVectors||((L=f.triangulation)==null?void 0:L.normals)||(f.attributes&&f.attributes.normal?f.attributes.normal.array:null),T=f.indices||f.triangles||f.indexes||((J=f.triangulation)==null?void 0:J.indices)||(f.index?f.index.array:null),M=fr($),O=fr(I),B=Xr(T);if(!M.length){console.warn("Skipping mesh without positions:",k,f),delete h[u];return}const N=Ct(f,k,{positions:M,normals:O,indices:B,color:xr(f.color)});if(N.faceMeshes.length===0){console.warn("Skipping mesh without face data:",k,f),delete h[u];return}const G=ge(M,B);v.push({id:k,name:_,definitionId:R,sourceMeshIndex:u,color:xr(f.color),position:f.position||[0,0,0],rotation:f.rotation||[0,0,0],scale:f.scale||[1,1,1],visible:!0,properties:Kr(f.properties,f.metadata,f.userData),geometry:{positions:M,normals:O,indices:B},edges:G.length?{positions:G}:void 0,isSolid:!0,geometryType:"solid",childrenIds:N.faceIds}),N.faceMeshes.forEach(x=>v.push(x))}),{meshes:v,meshIndexToId:h,meshIndexToName:p}},be=(c,v,h,p)=>{let g=0;const y=_=>(g+=1,(_||"node")+"_"+g),f=(_,R)=>{const $=_.meshIds||_.meshIndices||_.meshes;Array.isArray($)&&$.forEach(I=>{const T=_e(I,v)||String(I),O=(typeof I=="number"?h[I]:null)||T;R.push({id:y("leaf"),name:O,children:[],meshId:T,visible:!0})})},u=_=>{const R=[];Array.isArray(_.children)&&_.children.forEach(I=>R.push(u(I))),f(_,R);const $=_e(_.meshId??_.meshIndex,v)||_.meshId;return{id:_.id||y(_.name),name:_.name||_.label||"Unnamed",children:R,meshId:$||void 0,visible:typeof _.visible=="boolean"?_.visible:!0,properties:Kr(_.properties,_.metadata,_.userData)}},k=Array.isArray(c)?null:c;return k&&Array.isArray(k.nodes)?k.nodes.map(_=>u(_)):k&&k.root?[u(k.root)]:k&&Array.isArray(k.assemblies)?k.assemblies.map(_=>u(_)):[{id:y("root"),name:p||"STEP Model",children:Object.values(v).map(_=>({id:y("leaf"),name:_,children:[],meshId:_,visible:!0})),visible:!0}]},ke=.001,Fe=.003,Ae=.03,Se=.06,Jr=c=>{const v=br(pe(c,70)/100,0,1),h=ye(Ae,ke,v),p=ye(Se,Fe,v);return{linearDeflection:h,angularDeflection:p}},Te=c=>{const v=br(pe(c,70),0,100);return v>=70?"high":v<=30?"low":"medium"},Rt=(c,v)=>{const h=Jr(c),p=5e3,g=2e4,f=1-.6*(v<=p?0:v>=g?1:(v-p)/(g-p)),u=br(h.linearDeflection*f,ke,h.linearDeflection),k=br(h.angularDeflection*f,Fe,h.angularDeflection);return{linearDeflection:u,angularDeflection:k}},Nt=c=>{const v=Jr(c),h=Math.max(v.linearDeflection,Ae),p=Math.max(v.angularDeflection,Se);return{linearDeflection:br(v.linearDeflection*1.2,v.linearDeflection,h),angularDeflection:br(v.angularDeflection*1.2,v.angularDeflection,p)}},Zr=async(c,v,h,p)=>{const g=v instanceof ArrayBuffer?new Uint8Array(v):v;if(typeof c.FS_writeFile=="function"&&typeof c.ReadStepFile=="function"){const y="/input.step";c.FS_writeFile(y,g);try{return c.ReadStepFile(y,h)}catch{}}if(typeof c.ReadStepFile=="function")try{return c.ReadStepFile(g,h)}catch(y){if(v instanceof ArrayBuffer)return c.ReadStepFile(new Uint8Array(v),h);throw y}if(typeof c.readStepFile=="function")try{return c.readStepFile(g,h)}catch(y){if(v instanceof ArrayBuffer)return c.readStepFile(new Uint8Array(v),h);throw y}if(typeof c.parseStepFromArrayBuffer=="function")return c.parseStepFromArrayBuffer(v,{quality:Te(p)});throw new Error("OCCT STEP parser not found on module")},De=c=>{const v=[],h=new Set,p=g=>{!g||!g.buffer||g.buffer instanceof ArrayBuffer&&(h.has(g.buffer)||(h.add(g.buffer),v.push(g.buffer)))};return c.forEach(g=>{g.geometry&&(p(g.geometry.positions),p(g.geometry.normals),g.geometry.indices&&p(g.geometry.indices)),g.edges&&(p(g.edges.positions),g.edges.indices&&p(g.edges.indices))}),v},xt=c=>{const v=()=>c;let h=null;const p=async()=>h||(h=await gt({locateFile:v}),h);return{parseStep:async(y,f)=>{const{buffer:u,fileName:k,quality:_,fastMode:R}=y;f(10);const $=await p();if(f(30),R){const tr=Jr(_),cr=await Zr($,u,tr,_);f(70);const yr=It(cr),q=yr.meshes,Y=be(cr,yr.meshIndexToId,yr.meshIndexToName,k),ar=De(q);return f(100),{meshes:q,nodes:Y,transferables:ar}}const I=Nt(_);let T=await Zr($,u,I,_);f(55);let M=Ee(T),O=M.meshes,B=M.meshIndexToId,N=M.meshIndexToName;const G=Ft(O),V=At(O),L=Rt(_,G),J=L.angularDeflection<I.angularDeflection*.9||L.linearDeflection<I.linearDeflection*.9,x=G<=5e3?8e6:G<=1e4?5e6:3e6,W=Te(_)!=="low"&&V>0&&V<x;if(J&&W){f(65),O=[],M=null,T=await Zr($,u,L,_),f(80);const tr=Ee(T);O=tr.meshes,B=tr.meshIndexToId,N=tr.meshIndexToName}const Z=be(T,B,N,k);O.length||console.warn("OCCT parse returned no meshes",T);const or=De(O);return f(100),{meshes:O,nodes:Z,transferables:or}}}},Or=self,Ot=xt(ft);Or.onmessage=async c=>{const{type:v,payload:h}=c.data;if(v==="PARSE_STEP")try{const p=f=>{const u={type:"PROGRESS",progress:f};Or.postMessage(u)},g=await Ot.parseStep(h,p),y={type:"PARSE_COMPLETE",payload:{meshes:g.meshes,nodes:g.nodes}};Or.postMessage(y,g.transferables)}catch(p){const g={type:"PARSE_ERROR",error:p instanceof Error?p.message:String(p)};Or.postMessage(g)}}})();
